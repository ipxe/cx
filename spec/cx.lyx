#LyX 2.3 created this file. For more info see http://www.lyx.org/
\lyxformat 544
\begin_document
\begin_header
\save_transient_properties true
\origin unavailable
\textclass article
\begin_preamble
\usepackage[bookmarksnumbered=true,bookmarksopen=true,colorlinks=true,citecolor=blue,urlcolor=blue]{hyperref}
\usepackage{tocbibind}
\usepackage{url}
\usepackage{etoolbox}
\usepackage{draftwatermark}
\usepackage{titlesec}

\input{version.tex}

\newcommand{\cxDate}{
  \ifdefempty{\cxVersion}{
    \textbf{Draft}\space:\space\today
  }{
    Version\space\cxVersion\space:\space\today
  }
}

\SetWatermarkLightness{0.9}
\SetWatermarkScale{5}
\ifdefempty{\cxVersion}{
  \SetWatermarkText{DRAFT}
}{
  \SetWatermarkText{}
}
\end_preamble
\use_default_options true
\begin_modules
customHeadersFooters
\end_modules
\maintain_unincluded_children false
\language english
\language_package default
\inputencoding auto
\fontencoding global
\font_roman "default" "default"
\font_sans "default" "default"
\font_typewriter "default" "default"
\font_math "auto" "auto"
\font_default_family sfdefault
\use_non_tex_fonts false
\font_sc false
\font_osf false
\font_sf_scale 100 100
\font_tt_scale 100 100
\use_microtype false
\use_dash_ligatures true
\graphics default
\default_output_format default
\output_sync 0
\bibtex_command default
\index_command default
\float_placement H
\paperfontsize default
\spacing single
\use_hyperref false
\papersize default
\use_geometry true
\use_package amsmath 1
\use_package amssymb 1
\use_package cancel 1
\use_package esint 1
\use_package mathdots 1
\use_package mathtools 1
\use_package mhchem 1
\use_package stackrel 1
\use_package stmaryrd 1
\use_package undertilde 1
\cite_engine basic
\cite_engine_type default
\biblio_style plain
\use_bibtopic false
\use_indices false
\paperorientation portrait
\suppress_date false
\justification true
\use_refstyle 1
\use_minted 1
\index Index
\shortcut idx
\color #008000
\end_index
\leftmargin 2cm
\topmargin 2cm
\rightmargin 2cm
\bottommargin 2cm
\secnumdepth 4
\tocdepth 4
\paragraph_separation skip
\defskip medskip
\is_math_indent 0
\math_numbering_side default
\quotes_style english
\dynamic_quotes 0
\papercolumns 1
\papersides 1
\paperpagestyle fancy
\listings_params "style=colorful,fontsize={\small},samepage=true"
\tracking_changes false
\output_changes false
\html_math_output 0
\html_css_as_file 0
\html_be_strict false
\end_header

\begin_body

\begin_layout Title
CX: An architecture for privacy-compatible
\begin_inset Newline newline
\end_inset

distributed contact tracing
\end_layout

\begin_layout Author

\family typewriter
Michael Brown <
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
href{mailto:mcb30@ipxe.org}{mcb30@ipxe.org}
\end_layout

\end_inset

>
\end_layout

\begin_layout Date
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
cxDate
\end_layout

\end_inset


\end_layout

\begin_layout Left Header
CX: An architecture for privacy-compatible distributed contact tracing
\end_layout

\begin_layout Center Header

\end_layout

\begin_layout Right Header
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
cxDate
\end_layout

\end_inset


\end_layout

\begin_layout Left Footer
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
leftmark
\end_layout

\end_inset


\end_layout

\begin_layout Center Footer

\end_layout

\begin_layout Right Footer
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
thepage
\end_layout

\end_inset


\end_layout

\begin_layout Section
Overview
\begin_inset CommandInset label
LatexCommand label
name "sec:Overview"

\end_inset


\end_layout

\begin_layout Standard
CX is an architecture for privacy-compatible distributed contact tracing,
 designed for use in pandemics such as Covid-19.
 It operates using a model of proximity-based contact detection over one
 or more local area broadcast media such as Bluetooth Low Energy
\begin_inset space ~
\end_inset

(BLE).
 Pseudorandom contact identifiers are broadcast and recorded by all participatin
g devices.
 A sequence of previously broadcast contact identifiers may be retroactively
 associated with a hazard (such as a positive Covid-19 diagnosis), and the
 sequence then made available to all other participating devices.
\end_layout

\begin_layout Standard
The architecture provides the following features:
\end_layout

\begin_layout Itemize

\series bold
Zero information leakage
\series default
: for users who do not choose to disclose any information for contact tracing
 (e.g.
\begin_inset space ~
\end_inset

because they are never diagnosed with the disease), the information broadcast
 by that user is indistinguishable from an ideal random bitstring.
\end_layout

\begin_layout Itemize

\series bold
Zero collection of location information
\series default
: the devices running the protocol can choose to do so with no source of
 location information, and can therefore guarantee that no location history
 is collected.
\end_layout

\begin_layout Itemize

\series bold
Zero privilege
\series default
: there is no third party, central authority, or software provider who has
 privileged access to any data.
\end_layout

\begin_layout Itemize

\series bold
Trusted diagnoses
\series default
: governments and public health services provide trusted and digitally signed
 medical diagnoses, with the ability for users to distinguish between self-repor
ted symptoms and medical test results.
\end_layout

\begin_layout Itemize

\series bold
Distributed contact identification
\series default
: users can identify only their own hazardous contacts, and no central authority
 has access to the information required to identify contacts.
\end_layout

\begin_layout Itemize

\series bold
Immediate deployability
\series default
: the protocol may be implemented as an app on existing Android and iOS
 devices, with no requirement for changes to the core operating system.
\end_layout

\begin_layout Itemize

\series bold
Interoperability
\series default
: the protocol may be implemented by any device and as part of any app,
 with all apps and all devices able to benefit equally from the same distributed
 data set.
\end_layout

\begin_layout Itemize

\series bold
Flexibility
\series default
: multiple interoperating apps may exist to cover different user niches
 and preferences, with no restriction on development of new apps and no
 need for users to be running the same app.
\end_layout

\begin_layout Itemize

\series bold
International
\series default
: the protocol allows for multiple healthcare providers in multiple jurisdiction
s, with support for distributed contact identification even for users travelling
 across national boundaries.
\end_layout

\begin_layout Itemize

\series bold
Low bandwidth
\series default
: the protocol includes measures to reduce the bandwidth requirements to
 manageable levels even when dealing with billions of users and frequent
 requests.
\end_layout

\begin_layout Itemize

\series bold
Disconnected operation
\series default
: the protocol will operate without a data connection, including in environments
 such as underground, at sea, or within an aircraft.
\end_layout

\begin_layout Itemize

\series bold
Low resource
\series default
: the protocol may be implemented on embedded systems such as an ESP32 microcont
roller, enabling it to be deployed even in environments where typical Android
 or iPhone mobile devices are unaffordable.
\end_layout

\begin_layout Itemize

\series bold
Ease of implementation
\series default
: all cryptographic operations and data formats are chosen to be easily
 implemented using widely available and well-trusted existing libraries.
\begin_inset Newpage pagebreak
\end_inset


\end_layout

\begin_layout Standard
\noindent
\align center
\begin_inset Graphics
	filename broadcasting.svg
	width 80text%

\end_inset


\end_layout

\begin_layout Standard
Each participating device broadcasts a regular stream of messages.
 Each message contains a temporary unique
\series bold
 contact identifier
\series default
, which is a random string of numbers and letters such as 
\family typewriter
896e5b31-7c06-456d-afa9-472ae0163da6
\family default
.
\end_layout

\begin_layout Standard
Other devices that are nearby can observe the temporary unique contact identifie
r and can record it for future reference.
 The other devices do not receive any other information besides the contact
 identifier.
\end_layout

\begin_layout Standard
From the perspective of an observer, the contact identifier is completely
 meaningless: it is indistinguishable from random noise.
 The observer cannot use the contact identifier to deduce any information
 about the identity of the device.
\end_layout

\begin_layout Standard
The contact identifier changes frequently, making it impossible for unwanted
 observers (such as a stalker, or the owner of a shopping mall, or a government
 agency) to use it to track the device.
\end_layout

\begin_layout Standard
\noindent
\align center
\begin_inset Graphics
	filename observing.svg
	width 80text%

\end_inset


\end_layout

\begin_layout Standard
Each participating device also listens for messages broadcast by other nearby
 devices, and keeps a record of all the contact identifiers that it observes
 in these messages.
\end_layout

\begin_layout Standard
The contact identifiers are meaningless at the time they are observed.
 The only thing that the device can do is to record them for future reference.
\end_layout

\begin_layout Standard
The list of recorded contact identifiers is stored on the device and will
 never be shared with anyone.
\end_layout

\begin_layout Standard
The device may choose to record extra information, such as when or where
 the contact identifier was observed.
 This extra information is also stored on the device and will never be shared
 with anyone.
\end_layout

\begin_layout Standard
\noindent
\align center
\begin_inset Newpage pagebreak
\end_inset


\begin_inset Graphics
	filename diagnosis.svg
	width 80text%

\end_inset


\end_layout

\begin_layout Standard
If the device owner becomes infected, the healthcare provider generates
 a 
\series bold
confirmation code
\series default
 and communicates this confirmation code to the device owner.
 The device owner enters the confirmation code into the device.
\end_layout

\begin_layout Standard
The healthcare provider can choose how to communicate the confirmation code
 to the device owner.
 Some healthcare providers will find it easiest to simply read the number
 out in person.
 Other healthcare providers may choose to send confirmation codes via SMS
 messages, or through an existing online system.
\end_layout

\begin_layout Standard
The confirmation code allows the device to upload a list of the contact
 identifiers that it has broadcast over the past week.
 The list is uploaded to the healthcare provider's servers.
\end_layout

\begin_layout Standard
To save bandwidth, the device uploads only a single piece of information
 (a secret 
\series bold
seed value
\series default
) that it had used to generate its sequence of apparently random contact
 identifiers.
 This reduces the bandwidth required by around 99.9% compared to uploading
 the complete list.
\end_layout

\begin_layout Standard
The device owner makes a deliberate choice to upload the seed value in order
 to help alert other people.
 There is no way for anyone else to find out the seed value unless the device
 owner chooses to do this.
\end_layout

\begin_layout Standard
The seed value is the only piece of information that is uploaded.
 The healthcare provider has no way to know where the device owner has been
 or who the device owner has contacted.
\end_layout

\begin_layout Standard
\noindent
\align center
\begin_inset Graphics
	filename publication.svg
	width 80text%

\end_inset


\end_layout

\begin_layout Standard
The healthcare provider publishes a 
\series bold
notification
\series default
 list of hazardous seed values corresponding to positive diagnoses.
 Each participating device downloads this list and compares the hazardous
 contact identifiers against its own record of observed contact identifiers.
\end_layout

\begin_layout Standard
If an observer device finds a match, then it knows that it has recently
 been in close proximity to someone who has now been diagnosed and can raise
 an alert.
 The owner of the observer device can choose to take an appropriate action
 such as self-isolating.
\end_layout

\begin_layout Standard
The observer device can use any private information that it recorded at
 the time of observation to help assess the risk level.
 For example: if the observer device owner chose to record the time and
 location where the contact identifier was observed, then this could be
 used to determine that the contact took place while the owner was driving
 alone to work and so represents a harmless contact with another driver
 on the road.
\end_layout

\begin_layout Standard
The owner of a device has complete control over all the information associated
 with the contact.
 There is no way for anyone else to find out when or where a contact took
 place.
\end_layout

\begin_layout Standard
A healthcare provider can provide guidance or tools to assist in estimating
 the levels of risk and in suggesting the actions that should be taken by
 affected device owners.
\end_layout

\begin_layout Standard
\begin_inset Newpage pagebreak
\end_inset


\end_layout

\begin_layout Standard
\noindent
\align center
\begin_inset Graphics
	filename international.svg
	width 80text%

\end_inset


\end_layout

\begin_layout Standard
The volume of notifications is potentially very large.
 There are several mechanisms in place to minimise the amount of data that
 each device needs to download, but it is fundamentally implausible for
 every device to be aware of every notification in the world.
\end_layout

\begin_layout Standard
Most people do not travel internationally on a frequent basis.
 Most notifications are therefore not relevant to most people.
\end_layout

\begin_layout Standard
Healthcare providers publish a comprehensive list of notifications that
 are relevant to people within their geographical 
\series bold
subscription zone
\series default
.
 For a national healthcare provider, this subscription zone is the whole
 country.
\end_layout

\begin_layout Standard
Everyone subscribes to receive notifications from the subscription zone
 of their own country.
\end_layout

\begin_layout Standard
People who travel internationally can choose to also receive notifications
 from the subscription zones of any country through which they have recently
 travelled.
 Devices may choose to manage these subscriptions automatically for convenience.
\end_layout

\begin_layout Standard
People who are diagnosed after recent international travel can inform the
 healthcare provider.
 The healthcare provider then publishes the notification for that diagnosis
 to a special worldwide subscription zone.
 Other healthcare providers see this and include that notification within
 the comprehensive list that they publish for their own subscription zone.
\end_layout

\begin_layout Standard
The volume of notifications for people who have been diagnosed shortly after
 international travel is relatively small, and so does not result in excessive
 amounts of data to be downloaded.
\end_layout

\begin_layout Standard
For healthcare providers in very large geographic areas, this same hierarchical
 approach can be used to break down subscription zones to state or county
 levels.
\end_layout

\begin_layout Standard
\begin_inset Newpage pagebreak
\end_inset


\begin_inset CommandInset toc
LatexCommand tableofcontents

\end_inset


\end_layout

\begin_layout Section
Terminology
\begin_inset CommandInset label
LatexCommand label
name "sec:Terminology"

\end_inset


\end_layout

\begin_layout Standard
The key words 
\begin_inset Quotes eld
\end_inset

MUST
\begin_inset Quotes erd
\end_inset

, 
\begin_inset Quotes eld
\end_inset

MUST NOT
\begin_inset Quotes erd
\end_inset

, 
\begin_inset Quotes eld
\end_inset

REQUIRED
\begin_inset Quotes erd
\end_inset

, 
\begin_inset Quotes eld
\end_inset

SHALL
\begin_inset Quotes erd
\end_inset

, 
\begin_inset Quotes eld
\end_inset

SHALL NOT
\begin_inset Quotes erd
\end_inset

, 
\begin_inset Quotes eld
\end_inset

SHOULD
\begin_inset Quotes erd
\end_inset

, 
\begin_inset Quotes eld
\end_inset

SHOULD NOT
\begin_inset Quotes erd
\end_inset

, 
\begin_inset Quotes eld
\end_inset

RECOMMENDED
\begin_inset Quotes erd
\end_inset

, 
\begin_inset Quotes eld
\end_inset

MAY
\begin_inset Quotes erd
\end_inset

, and 
\begin_inset Quotes eld
\end_inset

OPTIONAL
\begin_inset Quotes erd
\end_inset

 in this document are to be interpreted as described in RFC
\begin_inset space ~
\end_inset

2119
\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand cite
key "RFC2119"
literal "false"

\end_inset

.
\end_layout

\begin_layout Description
Advertisement: A message broadcast by an 
\series bold
Advertiser
\series default
 containing a single 
\series bold
Contact Identifier
\series default
.
\end_layout

\begin_layout Description
Advertiser: The role played by a 
\series bold
Device
\series default
 in which it regularly broadcasts 
\series bold
Advertisements
\series default
 that may be received by other devices in their role as 
\series bold
Observers
\series default
.
\end_layout

\begin_layout Description
Alert
\begin_inset space ~
\end_inset

Level: A label that may be retroactively associated with a 
\series bold
Contact
\series default
 indicating a potential hazard presented by an 
\series bold
Advertiser
\series default
 to any 
\series bold
Observers
\series default
.
\end_layout

\begin_layout Description
Broadcast
\begin_inset space ~
\end_inset

Layer: A broadcast-capable commucations medium used to carry 
\series bold
Advertisements
\series default
.
\end_layout

\begin_layout Description
Confirmation
\begin_inset space ~
\end_inset

Code: A sequence of pseudorandom text characters generated by a 
\series bold
Publisher
\series default
 to confirm a diagnosis.
\end_layout

\begin_layout Description
Contact: A receipt of an 
\series bold
Advertisement
\series default
 by an 
\series bold
Observer
\series default
, indicating that the 
\series bold
Advertiser
\series default
 and 
\series bold
Observer
\series default
 are in close physical proximity.
\end_layout

\begin_layout Description
Contact
\begin_inset space ~
\end_inset

Alert: A 
\series bold
Contact
\series default
 within an 
\series bold
Observer's
\series default
 recorded history of received 
\series bold
Contact Identifiers
\series default
 that is subsequently associated with an 
\series bold
Alert Level
\series default
.
\end_layout

\begin_layout Description
Contact
\begin_inset space ~
\end_inset

Identifier: An RFC
\begin_inset space ~
\end_inset

4122
\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand cite
key "RFC4122"
literal "false"

\end_inset

 version
\begin_inset space ~
\end_inset

4 pseudo-random UUID generated using a 
\series bold
Generator
\series default
 and broadcast as part of an 
\series bold
Advertisement
\series default
.
\end_layout

\begin_layout Description
Device: An entity (such as a mobile phone) capable of simultaneously acting
 as both an 
\series bold
Advertiser
\series default
 and an 
\series bold
Observer
\series default
.
\end_layout

\begin_layout Description
DRBG: A Deterministic Random Bit Generator as defined by NIST
\begin_inset space ~
\end_inset

SP800-90A
\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand cite
key "SP800-90A"
literal "false"

\end_inset

.
\end_layout

\begin_layout Description
Generator: An algorithm as defined in section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Generator-Algorithms"
plural "false"
caps "false"
noprefix "false"

\end_inset

 used to generate 
\series bold
Contact Identifiers
\series default
.
\end_layout

\begin_layout Description
Generator
\begin_inset space ~
\end_inset

Type: An integer value as defined in section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Generator-Types"
plural "false"
caps "false"
noprefix "false"

\end_inset

 used as an input to a 
\series bold
Generator.
\end_layout

\begin_layout Description
Notification: A tuple comprising an 
\series bold
Alert Level
\series default
, a 
\series bold
Generator Type
\series default
 and a 
\series bold
Seed Value
\series default
 that appears within a 
\series bold
Publication
\series default
 and is used by an 
\series bold
Observer
\series default
 to identify 
\series bold
Contact Alerts
\series default
.
\end_layout

\begin_layout Description

\series bold
Observer:
\series default
 The role played by a 
\series bold
Device
\series default
 in which it listens for 
\series bold
Advertisements
\series default
 broadcast by other 
\series bold
Devices
\series default
 in their role as 
\series bold
Advertisers
\series default
 and records the received 
\series bold
Contact Identifiers
\series default
.
\end_layout

\begin_layout Description
Preseed
\begin_inset space ~
\end_inset

Key
\begin_inset space ~
\end_inset

Pair: An asymmetric key pair comprising a 
\series bold
Preseed Signing Key
\series default
 and a 
\series bold
Preseed Verification Key
\series default
.
\end_layout

\begin_layout Description
Preseed
\begin_inset space ~
\end_inset

Signing
\begin_inset space ~
\end_inset

Key: The private key component of a 
\series bold
Preseed Key Pair
\series default
 used to prove authorship of a 
\series bold
Seed Report
\series default
.
\end_layout

\begin_layout Description
Preseed
\begin_inset space ~
\end_inset

Value: A sequence of pseudorandom bytes used in conjunction with a 
\series bold
Preseed Verification Key
\series default
 to construct a 
\series bold
Seed Value
\series default
.
\end_layout

\begin_layout Description
Preseed
\begin_inset space ~
\end_inset

Verification
\begin_inset space ~
\end_inset

Key: The public key component of a 
\series bold
Preseed Key Pair
\series default
 used in conjunction with a 
\series bold
Preseed Value
\series default
 to construct a 
\series bold
Seed Value
\series default
.
\end_layout

\begin_layout Description
Publication: A set of 
\series bold
Notifications
\series default
 signed using a 
\series bold
Publisher Certificate 
\series default
that are made available for download by any interested 
\series bold
Observers
\series default
 or other 
\series bold
Publishers
\series default
.
\end_layout

\begin_layout Description
Publisher: An entity (such as a national health authority) that provides
 a source of 
\series bold
Publications
\series default
.
\end_layout

\begin_layout Description
Publisher
\begin_inset space ~
\end_inset

Certificate: An X.509
\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand cite
key "RFC5280"
literal "false"

\end_inset

 certificate identifing a 
\series bold
Publisher
\series default
.
\end_layout

\begin_layout Description
Publisher
\begin_inset space ~
\end_inset

Descriptor: A JSON document used to describe all relevant attributes of
 a 
\series bold
Publisher
\series default
.
\end_layout

\begin_layout Description
Publisher
\begin_inset space ~
\end_inset

Endpoint: An HTTP or HTTPS endpoint exposed by a 
\series bold
Publisher
\series default
 for use by 
\series bold
Advertisers
\series default
, 
\series bold
Observers
\series default
, and other 
\series bold
Publishers
\series default
.
\end_layout

\begin_layout Description
Publisher
\begin_inset space ~
\end_inset

Name: An arbitrary human-readable name used to informally disambiguate between
 
\series bold
Publishers
\series default
.
\end_layout

\begin_layout Description
Publisher
\begin_inset space ~
\end_inset

Signing
\begin_inset space ~
\end_inset

Key: The private key corresponding to a 
\series bold
Publisher Certificate
\series default
 used to prove authorship of a 
\series bold
Publication
\series default
.
\end_layout

\begin_layout Description
Seed
\begin_inset space ~
\end_inset

Calculator: An algorithm as defined in section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Seed-Calculator-Algorithms"
plural "false"
caps "false"
noprefix "false"

\end_inset

 used to construct 
\series bold
Seed Values
\series default
.
\end_layout

\begin_layout Description
Seed
\begin_inset space ~
\end_inset

Report: A tuple comprising a 
\series bold
Generator Type
\series default
, a 
\series bold
Preseed Value
\series default
, a 
\series bold
Preseed Verification Key
\series default
, and a 
\series bold
Seed Report Challenge 
\series default
that is signed using a 
\series bold
Preseed Signing Key
\series default
 and uploaded to a 
\series bold
Publisher
\series default
.
\end_layout

\begin_layout Description
Seed
\begin_inset space ~
\end_inset

Report
\begin_inset space ~
\end_inset

Challenge: A 
\series bold
Confirmation Code
\series default
 to be signed using a 
\series bold
Preseed Signing Key 
\series default
as part of a 
\series bold
Seed Report
\series default
.
\end_layout

\begin_layout Description
Seed
\begin_inset space ~
\end_inset

Value: A sequence of pseudorandom bytes used as an input to a 
\series bold
Generator
\series default
.
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
newcommand{
\backslash
sectionbreak}{
\backslash
clearpage}
\end_layout

\end_inset


\end_layout

\begin_layout Section
Broadcast Layer
\begin_inset CommandInset label
LatexCommand label
name "sec:Broadcast-Layer"

\end_inset


\end_layout

\begin_layout Standard
The protocol defined by this document is designed in terms of an abstract
 Broadcast Layer.
 Advertisers and Observers MAY support multiple Broadcast Layers concurrently.
 The only fundamental property required of a Broadcast Layer is the ability
 to broadcast and to receive a 16-byte RFC
\begin_inset space ~
\end_inset

4122
\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand cite
key "RFC4122"
literal "false"

\end_inset

 UUID.
\end_layout

\begin_layout Standard
It is expected that the initial implementation will use Bluetooth Low Energy
 (BLE) as the only available Broadcast Layer.
\end_layout

\begin_layout Standard
Advertisers MUST broadcast Advertisements on all supported Broadcast Layers.
 Advertisers MAY choose to use the same Contact Identifier on multiple Broadcast
 Layers.
\end_layout

\begin_layout Standard
Observers MUST listen for Advertisements on all supported Broadcast Layers.
\end_layout

\begin_layout Subsection
Broadcast Layer Requirements
\begin_inset CommandInset label
LatexCommand label
name "subsec:Broadcast-Layer-Requirements"

\end_inset


\end_layout

\begin_layout Standard
A Broadcast Layer MUST provide the ability for an Advertiser to logically
 broadcast a Contact Identifer (which is a 16-byte RFC
\begin_inset space ~
\end_inset

4122
\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand cite
key "RFC4122"
literal "false"

\end_inset

 UUID), and MUST provide the ability for nearby Observers to observe this
 broadcast Contact Identifier.
\end_layout

\begin_layout Standard
A Broadcast Layer MAY implement this logical broadcast functionality as
 a single physical broadcast.
 Where this is not possible due to external constraints (such as application-lev
el API limitations in mobile device operating systems), the Broadcast Layer
 MAY require additional packets to be exchanged in order to effect the transmiss
ion of the Contact Identifier from the Advertiser to the Observer.
\end_layout

\begin_layout Standard
A Broadcast Layer SHOULD NOT expose any additional information beyond the
 fact that this broadcast contains a Contact Identifier and the value of
 the Contact Identifier.
 Where this is not possible due to external constraints (such as the requirement
 for a link-layer header to include a hardware MAC address), the Broadcast
 Layer MUST employ techniques to eliminate or minimise the exposure of any
 information that could be used to identify an Advertiser or an Observer.
\end_layout

\begin_layout Standard
Such techniques MAY include the use of single-use or short-lived values
 for fields that would normally contain identifying information (such as
 a hardware MAC address).
 Where short-lived values are used, the lifecycle of these short-lived values
 MUST be synchronised with the lifecycle of a single Contact Identifier,
 to prevent the persistent identification of an Advertiser via linkage attacks.
\end_layout

\begin_layout Standard
Note that when the logical broadcast is implemented as a single physical
 broadcast, there is no need for any device to be able to respond to the
 physical broadcast or to be able to determine its origin.
 Under these circumstances, the Broadcast Layer MAY use fixed and non-identifyin
g values for fields that would normally contain identifying information
 (such as using an all-zero source MAC address).
\end_layout

\begin_layout Standard
A Broadcast Layer MUST require the addition of random jitter to the schedule
 of transmissions, to prevent the persistent identification of an Advertiser
 via measurement of broadcast timings.
\end_layout

\begin_layout Standard
An Observer MAY record additional relevant information provided by the Broadcast
 Layer at the time of receiving the Contact Identifier, such as received
 signal strength or distance from the Advertiser (if known).
 Such information is potentially useful when subsequently determining the
 risk level associated with a contact.
\end_layout

\begin_layout Standard
An Observer SHOULD NOT record additional information from the Broadcast
 Layer that is not relevant to determining the risk level associated with
 a contact (such as the link-layer MAC address presented by the Advertiser).
\end_layout

\begin_layout Section
Generators
\begin_inset CommandInset label
LatexCommand label
name "sec:Generators"

\end_inset


\end_layout

\begin_layout Standard
A Generator is used to construct a sequence of Contact Identifiers.
 The values of the Contact Identifiers are RFC
\begin_inset space ~
\end_inset

4122
\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand cite
key "RFC4122"
literal "false"

\end_inset

 version
\begin_inset space ~
\end_inset

4 pseudo-random UUIDs.
\end_layout

\begin_layout Standard
If the Seed Value used to create a Generator is not known, then the 122
 nonâ€“fixed bits of each 128-bit UUID form a bitstring that is indistinguishable
 from an ideal random bitstring up to a security strength as specified in
 section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Generator-Types"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
\end_layout

\begin_layout Standard
Appendix
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Generator-Sample-Code"
plural "false"
caps "false"
noprefix "false"

\end_inset

 provides sample code for a Generator using the standard OpenSSL
\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand cite
key "OpenSSL"
literal "false"

\end_inset

 library.
 Generator implementations MUST produce a sequence of Contact Identifiers
 matching the test vectors given in Appendix
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Generator-Test-Vectors"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
\end_layout

\begin_layout Subsection
Generator Types
\begin_inset CommandInset label
LatexCommand label
name "subsec:Generator-Types"

\end_inset


\end_layout

\begin_layout Standard
The following Generator Type values are defined:
\end_layout

\begin_layout Standard
\noindent
\align center
\begin_inset Tabular
<lyxtabular version="3" rows="3" columns="7">
<features tabularvalignment="middle">
<column alignment="center" valignment="middle" width="10text%">
<column alignment="center" valignment="middle" width="20text%">
<column alignment="center" valignment="middle" width="10text%">
<column alignment="center" valignment="middle" width="10text%">
<column alignment="center" valignment="middle" width="10text%">
<column alignment="center" valignment="middle" width="10text%">
<column alignment="center" valignment="middle" width="10text%">
<row>
<cell alignment="center" valignment="top" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Type
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
DRBG Mechanism
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Security Strength (bits)
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Seed Length (bytes) 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Entropy Input Length (bytes)
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Nonce Length (bytes)
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Maximum Iterations
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
CTR_DRBG using AES-128 with DF
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
128
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
24
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
16
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
8
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
2048
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
2
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
CTR_DRBG using AES-256 with DF
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
256
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
48
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
32
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
16
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
2048
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\begin_layout Standard
All other Generator Type values are reserved for future use.
\end_layout

\begin_layout Standard
Advertisers SHOULD choose to use Generator Type 1 when generating Contact
 Identifiers for inclusion in Advertisements.
\end_layout

\begin_layout Standard
Observers MUST support all defined Generator Types when processing Notifications
 to identify Contact Alerts.
 Observers MUST accept a Notification containing a Generator Type that they
 do not recognise.
 Observers SHOULD warn the user and provide a facility for resolving the
 unrecognised Generator Type (e.g.
\begin_inset space ~
\end_inset

by updating to a newer version of the software and reprocessing the Notification
).
\end_layout

\begin_layout Standard
For all Generator Types, the Seed Length SHALL be equal to the sum of the
 Entropy Input Length and the Nonce Length.
\end_layout

\begin_layout Standard
The underlying DRBG mechanisms are defined by NIST
\begin_inset space ~
\end_inset

SP800-90A
\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand cite
key "SP800-90A"
literal "false"

\end_inset

 and MUST be used as specified in section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Generator-Algorithms"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
\end_layout

\begin_layout Subsection
Generator Algorithms
\begin_inset CommandInset label
LatexCommand label
name "subsec:Generator-Algorithms"

\end_inset


\end_layout

\begin_layout Standard
An Advertiser SHALL use the algorithm defined in this section to generate
 a sequence of Contact Identifiers for inclusion in Advertisements.
\end_layout

\begin_layout Standard
An Observer SHALL use the algorithm defined in this section to regenerate
 the sequence of Contact Identifiers corresponding to a Notification.
\end_layout

\begin_layout Standard
A Publisher has no need for the algorithm defined in this section since
 Contact Identifiers do not appear directly in Notifications.
\end_layout

\begin_layout Standard
The algorithm comprises three steps:
\end_layout

\begin_layout Enumerate
Instantiate the Generator using the algorithm defined in section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Generator-Instantiation"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
\end_layout

\begin_layout Enumerate
Iterate over the Generator using the algorithm defined in section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Generator-Iteration"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
\end_layout

\begin_layout Enumerate
Uninstantiate the Generator using the algorithm defined in section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Generator-Uninstantiation"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
\end_layout

\begin_layout Subsubsection
Generator State
\begin_inset CommandInset label
LatexCommand label
name "subsec:Generator-State"

\end_inset


\end_layout

\begin_layout Standard
The state of a Generator comprises:
\end_layout

\begin_layout Itemize
A Generator Iteration Counter.
\end_layout

\begin_layout Itemize
A Generator DRBG instantiated using the algorithm defined in section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Generator-Instantiation"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
\end_layout

\begin_layout Subsubsection
Generator Instantiation
\begin_inset CommandInset label
LatexCommand label
name "subsec:Generator-Instantiation"

\end_inset


\end_layout

\begin_layout Standard
The input required to instantiate a Generator comprises:
\end_layout

\begin_layout Itemize
A Generator Type as defined in section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Generator-Types"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
\end_layout

\begin_layout Itemize
A Seed Value of the Seed Length specified for the Generator Type in section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Generator-Types"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
\end_layout

\begin_layout Standard
A Generator SHALL initialise the Generator Iteration Counter to zero.
\end_layout

\begin_layout Standard
A Generator SHALL instantiate a Generator DRBG using functionality equivalent
 to the 
\series bold
Instantiate_function
\series default
 as defined in NIST
\begin_inset space ~
\end_inset

SP800-90A
\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand cite
key "SP800-90A"
literal "false"

\end_inset

 section
\begin_inset space ~
\end_inset

9.1 with the following parameters:
\end_layout

\begin_layout Itemize
The DRBG mechanism SHALL be the DRBG Mechanism specified for the Generator
 Type in section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Generator-Types"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
\end_layout

\begin_layout Itemize
The 
\emph on
requested_instantiation_security_strength
\emph default
 SHALL be set to the Security Strength specified for the Generator Type
 in section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Generator-Types"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
\end_layout

\begin_layout Itemize
The 
\emph on
prediction_resistance_flag
\emph default
 SHALL be set to False.
\end_layout

\begin_layout Itemize
The 
\emph on
personalization_string
\emph default
 SHALL be omitted.
\end_layout

\begin_layout Itemize
The 
\emph on
entropy_input
\emph default
 value returned by the 
\series bold
Get_entropy_input
\series default
 function SHALL be the first N bytes of the Seed Value, where N is the Entropy
 Input Length specified for the Generator Type in section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Generator-Types"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
\end_layout

\begin_layout Itemize
The 
\emph on
nonce
\emph default
 value SHALL be the last M bytes of the Seed Value, where M is the Nonce
 Length specified for the Generator Type in section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Generator-Types"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
\end_layout

\begin_layout Standard
Note that this algorithm violates the wording of NIST
\begin_inset space ~
\end_inset

SP800-90A
\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand cite
key "SP800-90A"
literal "false"

\end_inset

 that for 
\emph on
entropy_input
\emph default
 and 
\emph on
nonce
\emph default
:
\end_layout

\begin_layout Quote
\begin_inset Quotes eld
\end_inset

This information 
\series bold
shall not
\series default
 be provided by the consuming application as an input parameter during the
 instantiate request
\begin_inset Quotes erd
\end_inset


\end_layout

\begin_layout Standard
This violation is REQUIRED in order to allow an Observer to reconstruct
 a sequence of Contact Identifiers previously broadcast by an Advertiser,
 where the Advertiser has intentionally chosen to disclose the Seed Value
 by means of a Seed Report for inclusion in a Notification.
\end_layout

\begin_layout Standard
An Advertiser MUST construct new Seed Values using the algorithm defined
 in section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Seed-Calculators"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
\end_layout

\begin_layout Standard
Appendix
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Generator-Sample-Code"
plural "false"
caps "false"
noprefix "false"

\end_inset

 provides sample code for Generator instantiation using the standard OpenSSL
\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand cite
key "OpenSSL"
literal "false"

\end_inset

 library.
\end_layout

\begin_layout Subsubsection
Generator Iteration
\begin_inset CommandInset label
LatexCommand label
name "subsec:Generator-Iteration"

\end_inset


\end_layout

\begin_layout Standard
A Generator SHALL generate the next Contact Identifier in a sequence as
 follows:
\end_layout

\begin_layout Itemize
If the Generator Iteration Counter has reached the Maximum Iterations specified
 for the Generator Type in section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Generator-Types"
plural "false"
caps "false"
noprefix "false"

\end_inset

 then return with an error indicating that the Generator is exhausted.
\end_layout

\begin_layout Itemize
Increment the Generator Iteration Counter by one.
\end_layout

\begin_layout Itemize
Generate the next 16 bytes (128 bits) of pseudorandom bits from the Generator
 DRBG using functionality equivalent to the 
\series bold
Generate_function
\series default
 as defined in NIST
\begin_inset space ~
\end_inset

SP800-90A
\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand cite
key "SP800-90A"
literal "false"

\end_inset

 section
\begin_inset space ~
\end_inset

9.3.1 with the following parameters:
\end_layout

\begin_deeper
\begin_layout Itemize
The 
\emph on
state_handle
\emph default
 SHALL be set to the 
\emph on
state_handle
\emph default
 returned by the call to 
\series bold
Instantiate_function
\series default
 from section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Generator-Instantiation"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
\end_layout

\begin_layout Itemize
The 
\emph on
requested_number_of_bits
\emph default
 SHALL be set to 128.
\end_layout

\begin_layout Itemize
The 
\emph on
requested_security_strength
\emph default
 SHALL be set to the Security Strength specified for the Generator Type
 in section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Generator-Types"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
\end_layout

\begin_layout Itemize
The 
\emph on
prediction_resistance_request
\emph default
 flag SHALL be set to False.
\end_layout

\begin_layout Itemize
The 
\emph on
additional_input
\emph default
 SHALL be omitted.
\end_layout

\end_deeper
\begin_layout Itemize
Treat the 16 bytes of pseudorandom bits as a UUID with all fields in network
 byte order as defined by RFC
\begin_inset space ~
\end_inset

4122
\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand cite
key "RFC4122"
literal "false"

\end_inset

.
\end_layout

\begin_layout Itemize
Set the fixed bits that are required for a version
\begin_inset space ~
\end_inset

4 UUID as specified in RFC
\begin_inset space ~
\end_inset

4122
\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand cite
key "RFC4122"
literal "false"

\end_inset

 section
\begin_inset space ~
\end_inset

4.4:
\end_layout

\begin_deeper
\begin_layout Itemize
Set the two most significant bits (bits 7 and 6) of the 
\emph on
clock_seq_hi_and_reserved
\emph default
 to the binary value 10.
\end_layout

\begin_layout Itemize
Set the four most significant bits (bits 15 through 12) of the 
\emph on
time_hi_and_version
\emph default
 field to the binary value 0100.
\end_layout

\begin_layout Itemize
Leave all other bits unaltered from the pseudorandom bits produced by the
 call to 
\series bold
Generate_function
\series default
.
\end_layout

\end_deeper
\begin_layout Itemize
Return this UUID as the next Contact Identifier.
\end_layout

\begin_layout Standard
A Generator MUST NOT use the Generator DRBG for any purpose other than generatin
g Contact Identifiers using the algorithm defined in this section.
\end_layout

\begin_layout Standard
A Generator MUST limit the total cumulative number of iterations since instantia
tion to not exceed the Maximum Iterations specified for the Generator Type
 in section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Generator-Types"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
\end_layout

\begin_layout Standard
Appendix
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Generator-Sample-Code"
plural "false"
caps "false"
noprefix "false"

\end_inset

 provides sample code for Generator iteration using the standard OpenSSL
\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand cite
key "OpenSSL"
literal "false"

\end_inset

 library.
\end_layout

\begin_layout Subsubsection
Generator Uninstantiation
\begin_inset CommandInset label
LatexCommand label
name "subsec:Generator-Uninstantiation"

\end_inset


\end_layout

\begin_layout Standard
A Generator SHALL uninstantiate the DRBG using functionality equivalent
 to the 
\series bold
Uninstantiate_function
\series default
 as defined in NIST
\begin_inset space ~
\end_inset

SP800-90A
\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand cite
key "SP800-90A"
literal "false"

\end_inset

 section
\begin_inset space ~
\end_inset

9.4.
\end_layout

\begin_layout Standard
Appendix
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Generator-Sample-Code"
plural "false"
caps "false"
noprefix "false"

\end_inset

 provides sample code for Generator uninstantiation using the standard OpenSSL
\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand cite
key "OpenSSL"
literal "false"

\end_inset

 library.
\end_layout

\begin_layout Section
Seed Calculators
\begin_inset CommandInset label
LatexCommand label
name "sec:Seed-Calculators"

\end_inset


\end_layout

\begin_layout Standard
A Seed Calculator is used to construct a Seed Value.
 The Seed Value is used as the initial input to a Generator, which is then
 used to construct a sequence of Contact Identifiers.
\end_layout

\begin_layout Standard
A Seed Value is constructed from a Preseed Value and a Preseed Verification
 Key.
 If the Preseed Value and Preseed Verification Key are not known, then the
 Seed Value is indistinguishable from an ideal random bitstring up to a
 security strength as specified in section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Generator-Types"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
\end_layout

\begin_layout Standard
Appendix
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Seed-Calculator-Sample"
plural "false"
caps "false"
noprefix "false"

\end_inset

 provides sample code for a Seed Calculator using the standard OpenSSL
\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand cite
key "OpenSSL"
literal "false"

\end_inset

 library.
 Seed Calculator implementations MUST produce Seed Values matching the test
 vectors given in Appendix
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Seed-Calculator-Test"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
\end_layout

\begin_layout Subsection
Seed Calculator Algorithms
\begin_inset CommandInset label
LatexCommand label
name "subsec:Seed-Calculator-Algorithms"

\end_inset


\end_layout

\begin_layout Standard
An Advertiser SHALL use the algorithm defined in this section to construct
 a Seed Value for instantiating a Generator.
\end_layout

\begin_layout Standard
A Publisher SHALL use the algorithm defined in this section to construct
 a Seed Value for inclusion in a Notification.
\end_layout

\begin_layout Standard
An Observer has no need for the algorithm defined in this section, since
 the constructed Seed Value is already present in the Notification and is
 signed by the Pubisher Certificate.
\end_layout

\begin_layout Standard
The algorithm comprises three steps:
\end_layout

\begin_layout Enumerate
Instantiate the Seed Calculator using the algorithm defined in section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Seed-Calculator-Instantiation"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
\end_layout

\begin_layout Enumerate
Construct the Seed Value using the algorithm defined in section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Seed-Calculator-Generation"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
\end_layout

\begin_layout Enumerate
Uninstantiate the Seed Calculator using the algorithm defined in section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Seed-Calculator-Uninstantiation"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
\end_layout

\begin_layout Standard
In the terminology of NIST
\begin_inset space ~
\end_inset

SP800-90C
\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand cite
key "SP800-90C"
literal "false"

\end_inset

 section 10.1.1, the combination of a Seed Calculator and a Generator produces
 an Approved construction in which the Seed Calculator is used as the source
 DRBG and the Generator is used as the target DRBG.
\end_layout

\begin_layout Subsubsection
Seed Calculator State
\begin_inset CommandInset label
LatexCommand label
name "subsec:Seed-Calculator-State"

\end_inset


\end_layout

\begin_layout Standard
The state of a Seed Calculator comprises:
\end_layout

\begin_layout Itemize
A Seed Calculator DRBG instantiated using the algorithm defined in section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Seed-Calculator-Instantiation"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
\end_layout

\begin_layout Subsubsection
Seed Calculator Instantiation
\begin_inset CommandInset label
LatexCommand label
name "subsec:Seed-Calculator-Instantiation"

\end_inset


\end_layout

\begin_layout Standard
The input required to instantiate a Seed Calculator comprises:
\end_layout

\begin_layout Itemize
A Generator Type as defined in section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Generator-Types"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
\end_layout

\begin_layout Itemize
A Preseed Value of the Seed Length specified for the Generator Type in section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Generator-Types"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
\end_layout

\begin_layout Itemize
A Preseed Verification Key.
\end_layout

\begin_layout Standard
A Seed Calculator SHALL instantiate a Seed Calculator DRBG using functionality
 equivalent to the 
\series bold
Instantiate_function
\series default
 as defined in NIST
\begin_inset space ~
\end_inset

SP800-90A
\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand cite
key "SP800-90A"
literal "false"

\end_inset

 section 9.1 with the following parameters:
\end_layout

\begin_layout Itemize
The DRBG mechanism SHALL be the DRBG Mechanism specified for the Generator
 Type in section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Generator-Types"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
\end_layout

\begin_layout Itemize
The 
\emph on
requested_instantiation_security_strength
\emph default
 SHALL be set to the Security Strength specified for the Generator Type
 in section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Generator-Types"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
\end_layout

\begin_layout Itemize
The 
\emph on
prediction_resistance_flag
\emph default
 SHALL be set to False.
\end_layout

\begin_layout Itemize
The 
\emph on
personalization_string
\emph default
 SHALL be set to the Preseed Verification Key encoded using the ASN.1
\begin_inset space ~
\end_inset

DER
\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand cite
key "X.690"
literal "false"

\end_inset

 encoding of the 
\series bold
SubjectPublicKeyInfo
\series default
 field as defined by X.509
\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand cite
key "RFC5280"
literal "false"

\end_inset

 section
\begin_inset space ~
\end_inset

4.1.
\end_layout

\begin_layout Itemize
The 
\emph on
entropy_input
\emph default
 value returned by the 
\series bold
Get_entropy_input
\series default
 function SHALL be the first N bytes of the Preseed Value, where N is the
 Entropy Input Length specified for the Generator Type in section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Generator-Types"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
\end_layout

\begin_layout Itemize
The 
\emph on
nonce
\emph default
 value SHALL be the last M bytes of the Preseed Value, where M is the Nonce
 Length specified for the Generator Type in section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Generator-Types"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
\end_layout

\begin_layout Standard
Note that this algorithm violates the wording of NIST
\begin_inset space ~
\end_inset

SP800-90A
\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand cite
key "SP800-90A"
literal "false"

\end_inset

 that for 
\emph on
entropy_input
\emph default
 and 
\emph on
nonce
\emph default
:
\end_layout

\begin_layout Quote
\begin_inset Quotes eld
\end_inset

This information 
\series bold
shall not
\series default
 be provided by the consuming application as an input parameter during the
 instantiate request
\begin_inset Quotes erd
\end_inset


\end_layout

\begin_layout Standard
This violation is REQUIRED in order to allow a Publisher to reconstruct
 a Seed Value, where the Advertiser has intentionally chosen to disclose
 the Preseed Value by means of a Seed Report for inclusion of the resulting
 Seed Value in a Notification.
\end_layout

\begin_layout Standard
An Advertiser MUST construct the Preseed Value using an RBG that is known
 to have a security strength equal to or greater than the security strength
 specified for the Generator Type in section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Generator-Types"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
\end_layout

\begin_layout Standard
Appendix
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Seed-Calculator-Sample"
plural "false"
caps "false"
noprefix "false"

\end_inset

 provides sample code for Seed Calculator instantiation using the standard
 OpenSSL
\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand cite
key "OpenSSL"
literal "false"

\end_inset

 library.
\end_layout

\begin_layout Paragraph*
Caveat
\end_layout

\begin_layout Standard
Note that the definition of the 
\series bold
SubjectPublicKeyInfo
\series default
 field in X.509
\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand cite
key "RFC5280"
literal "false"

\end_inset

 allows for some freedom of choice in representation.
 For example, when the 
\series bold
algorithmIdentifier
\series default
 field requires no parameters, some implementations will choose to set the
 
\series bold
parameters
\series default
 field to an explicit ASN.1 NULL, while some implementations will choose
 to simply omit the 
\series bold
parameters
\series default
 field.
\end_layout

\begin_layout Standard
It is REQUIRED that any such implementation choices are made consistently
 for any given Preseed Verification Key, since any variation in the encoded
 Preseed Verification Key will result in the construction of an incorrect
 Seed Value.
\end_layout

\begin_layout Standard
Advertisers MAY choose any valid ASN.1
\begin_inset space ~
\end_inset

DER encoding of 
\series bold
SubjectPublicKeyInfo
\series default
.
 Advertisers MUST choose this same encoding of 
\series bold
SubjectPublicKeyInfo
\series default
 for all uses of the Preseed Verification Key, including when constructing
 a Seed Report.
\end_layout

\begin_layout Standard
Publishers MUST use the ASN.1
\begin_inset space ~
\end_inset

DER encoding exactly as presented in the Seed Report.
\end_layout

\begin_layout Subsubsection
Seed Calculator Generation
\begin_inset CommandInset label
LatexCommand label
name "subsec:Seed-Calculator-Generation"

\end_inset


\end_layout

\begin_layout Standard
A Seed Calculator SHALL generate the Seed Value as follows:
\end_layout

\begin_layout Itemize
Generate pseudorandom bits from the Seed Calculator DRBG using functionality
 equivalent to the 
\series bold
Generate_function
\series default
 as defined in NIST
\begin_inset space ~
\end_inset

SP800-90A
\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand cite
key "SP800-90A"
literal "false"

\end_inset

 section
\begin_inset space ~
\end_inset

9.3.1 with the following parameters:
\end_layout

\begin_deeper
\begin_layout Itemize
The 
\emph on
state_handle
\emph default
 SHALL be set to the 
\emph on
state_handle
\emph default
 returned by the call to 
\series bold
Instantiate_function
\series default
 from section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Seed-Calculator-Instantiation"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
\end_layout

\begin_layout Itemize
The 
\emph on
requested_number_of_bits
\emph default
 SHALL be set to the number of bits in the Seed Length specified for the
 Generator Type in section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Generator-Types"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
 (Note that the Seed Length is specified as a number of bytes.)
\end_layout

\begin_layout Itemize
The 
\emph on
requested_security_strength
\emph default
 SHALL be set to the Security Strength specified for the Generator Type
 in section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Generator-Types"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
\end_layout

\begin_layout Itemize
The 
\emph on
prediction_resistance_request
\emph default
 flag SHALL be set to False.
\end_layout

\begin_layout Itemize
The 
\emph on
additional_input
\emph default
 SHALL be omitted.
\end_layout

\end_deeper
\begin_layout Itemize
Return these bytes as the Seed Value.
\end_layout

\begin_layout Standard
A Seed Calculator MUST NOT use the Seed Calculator DRBG for any purpose
 other than generating the Seed Value using the algorithm defined in this
 section.
\end_layout

\begin_layout Standard
Appendix
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Seed-Calculator-Sample"
plural "false"
caps "false"
noprefix "false"

\end_inset

 provides sample code for Seed Calculator generation using the standard
 OpenSSL
\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand cite
key "OpenSSL"
literal "false"

\end_inset

 library.
\end_layout

\begin_layout Subsubsection
Seed Calculator Uninstantiation
\begin_inset CommandInset label
LatexCommand label
name "subsec:Seed-Calculator-Uninstantiation"

\end_inset


\end_layout

\begin_layout Standard
A Seed Calculator SHALL uninstantiate the DRBG using functionality equivalent
 to the 
\series bold
Uninstantiate_function
\series default
 as defined in NIST
\begin_inset space ~
\end_inset

SP800-90A
\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand cite
key "SP800-90A"
literal "false"

\end_inset

 section
\begin_inset space ~
\end_inset

9.4.
\end_layout

\begin_layout Standard
Appendix
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Seed-Calculator-Sample"
plural "false"
caps "false"
noprefix "false"

\end_inset

 provides sample code for Seed Calculator uninstantiation using the standard
 OpenSSL
\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand cite
key "OpenSSL"
literal "false"

\end_inset

 library.
\end_layout

\begin_layout Section
Seed Reports
\begin_inset CommandInset label
LatexCommand label
name "sec:Seed-Reports"

\end_inset


\end_layout

\begin_layout Standard
A Seed Report is a message constructed by an Advertiser to be sent to a
 Publisher.
 The Seed Report is used to disclose and to verify original authorship of
 a set of Seed Values and to associate the Seed Values with an Alert Level
 for inclusion into a Notification.
\end_layout

\begin_layout Standard
A Seed Report is submitted via a Seed Report Endpoint as defined in section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Seed-Report-Endpoint"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
\end_layout

\begin_layout Standard
The act of sending a Seed Report is a deliberate disclosure of a set of
 Preseed Values and Seed Values.
 Once the Seed Report has been sent, the included Preseed Values (and the
 derived Seed Values) are no longer private to the Advertiser.
\end_layout

\begin_layout Standard
An Advertiser MUST NOT transmit any Contact Identifiers generated by a Generator
 instance once the Seed Report corresponding to that Generator's Seed Value
 has been sent.
\end_layout

\begin_layout Standard
The Preseed Signing Keys remain private to the Advertiser at all times,
 and are not disclosed by sending a Seed Report.
 The act of sending a Seed Report does disclose that the Advertiser is in
 possession of the Preseed Signing Keys, but does not disclose their values.
\end_layout

\begin_layout Standard
Note that the Seed Report does not directly convey an Alert Level; see section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Seed-Report-Challenges"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
\end_layout

\begin_layout Subsection
Seed Report Challenges
\begin_inset CommandInset label
LatexCommand label
name "subsec:Seed-Report-Challenges"

\end_inset


\end_layout

\begin_layout Standard
The association between the Seed Values and the Alert Level is conveyed
 using a Seed Report Challenge.
 The Seed Report Challenge contains a Confirmation Code, which is a single-use
 short-lived authorisation code provided by the Publisher to the Advertiser
 through an out-of-band mechanism.
\end_layout

\begin_layout Standard
For example: a national health authority (a Publisher) could provide its
 practitioners with the ability to record a positive diagnosis of a patient
 into the health authority's existing systems.
 The health authority could then generate a 16-digit PIN code (the Confirmation
 Code) which is associated in the health authority's database with the positive
 diagnosis.
 The 16-digit PIN code is given by the practitioner to the patient, who
 enters it into the Advertiser Device.
 The Advertiser Device then generates and sends a Seed Report which incorporates
 the Confirmation Code (in the Seed Report Challenge field), thereby allowing
 the health authority (the Publisher) to link the Seed Report to the diagnosis
 already recorded in its database.
\end_layout

\begin_layout Standard
The mechanism for conveying the Confirmation Code is deliberately left unspecifi
ed by this document, since the optimal approach will vary according to the
 needs and existing capabilities of each Publisher.
 Some potential mechanisms are:
\end_layout

\begin_layout Itemize
A numeric PIN code that is provided verbally and entered by the patient
 on the patient's device
\end_layout

\begin_layout Itemize
An SMS message sent to the patient containing a link that is recognised
 by the app running on the patient's device
\end_layout

\begin_layout Itemize
A QR code that is scanned by the patient
\end_layout

\begin_layout Standard
An Advertiser MUST provide a capability for the user to interactively enter
 an arbitrary UTF-8 string as the Confirmation Code, and MAY provide other
 capabilities such as scanning a QR code or recognising a Publisher-specific
 URI format in a link.
\end_layout

\begin_layout Standard
A Publisher MUST provide the user with the Confirmation Code in the form
 of a realistically transcribable UTF-8 string for interactive entry by
 the user, and MAY provide the user with the Confirmation Code through other
 means such as an SMS message.
\end_layout

\begin_layout Standard
The Seed Report Challenge serves two purposes: it provides a means to convey
 the Confirmation Code from the Advertiser to the Publisher, and it also
 acts as the challenge in a challenge-response authentication using the
 Preseed Signing Key as the secret.
 This challenge-response authentication does not establish an identity but
 does establish that the Advertiser is in possession of the Preseed Signing
 Key, and thereby prevents an attacker from constructing a valid Seed Report
 for a previously disclosed Seed Value.
\end_layout

\begin_layout Subsection
Seed Report Algorithms
\begin_inset CommandInset label
LatexCommand label
name "subsec:Seed-Report-Algorithms"

\end_inset


\end_layout

\begin_layout Standard
An Advertiser SHALL use the construction algorithm defined in section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Seed-Report-Construction"
plural "false"
caps "false"
noprefix "false"

\end_inset

 to construct a Seed Report for uploading to a Publisher.
\end_layout

\begin_layout Standard
A Publisher SHALL use the interpretation algorithm defined in section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Seed-Report-Interpretation"
plural "false"
caps "false"
noprefix "false"

\end_inset

 to interpret a Seed Report prior to inclusion of the Seed Values in a Notificat
ion.
\end_layout

\begin_layout Standard
An Observer has no need for the algorithms defined in this section since
 Observers do not receive Seed Reports.
\end_layout

\begin_layout Subsubsection
Seed Report Construction Algorithm
\begin_inset CommandInset label
LatexCommand label
name "subsec:Seed-Report-Construction"

\end_inset


\end_layout

\begin_layout Standard
The algorithm comprises 3 steps:
\end_layout

\begin_layout Enumerate
Construct a 
\series bold
TBSSeedReport
\series default
 data object as defined in section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:TBSSeedReport-fields"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
\end_layout

\begin_layout Enumerate
Compute the 
\series bold
signatureValues
\series default
 as defined in section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "par:SeedReport-signatureValues"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
\end_layout

\begin_layout Enumerate
Construct a 
\series bold
SeedReport
\series default
 data object incorporating both the 
\series bold
tbsSeedReport
\series default
 and 
\series bold
signatureValues
\series default
 as defined in section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:SeedReport-fields"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
\end_layout

\begin_layout Subsubsection
Seed Report Interpretation Algorithm
\begin_inset CommandInset label
LatexCommand label
name "subsec:Seed-Report-Interpretation"

\end_inset


\end_layout

\begin_layout Standard
The algorithm comprises 6 steps:
\end_layout

\begin_layout Enumerate
Extract the 
\series bold
tbsSeedReport
\series default
 and 
\series bold
signatureValues
\series default
 fields from the 
\series bold
SeedReport
\series default
 data object as defined in section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:SeedReport-fields"
plural "false"
caps "false"
noprefix "false"

\end_inset


\end_layout

\begin_layout Enumerate
Extract the 
\series bold
seedDescriptors
\series default
 field from the 
\series bold
TBSSeedReport
\series default
 data object as defined in section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:TBSSeedReport-fields"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
\end_layout

\begin_layout Enumerate
Extract the 
\series bold
signatureAlgorithm
\series default
 and 
\series bold
preseedVerificationKey
\series default
 fields from each element of the 
\series bold
seedDescriptors
\series default
 list as defined in section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:SeedDescriptor-fields"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
\end_layout

\begin_layout Enumerate
For each element in the 
\series bold
seedDescriptors
\series default
 list, verify that the 
\series bold
signatureAlgorithm
\series default
 is compatible as defined in section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "par:SeedDescriptor-signatureAlgorithm"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
\end_layout

\begin_layout Enumerate
For each element in the 
\series bold
seedDescriptors
\series default
 list, verify that the corresponding 
\series bold
SignatureValue
\series default
 is correct as defined in section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "par:SeedReport-signatureValues"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
\end_layout

\begin_layout Enumerate
Interpret the 
\series bold
tbsSeedReport
\series default
 fields as defined in section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:TBSSeedReport-fields"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
\end_layout

\begin_layout Subsection
Seed Report Layout
\begin_inset CommandInset label
LatexCommand label
name "subsec:Seed-Report-Layout"

\end_inset


\end_layout

\begin_layout Standard
A Seed Report is the ASN.1
\begin_inset space ~
\end_inset

DER
\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand cite
key "X.690"
literal "false"

\end_inset

 encoding of a 
\series bold
SeedReport
\series default
 data object as defined in section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:SeedReport-fields"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
 A full ASN.1
\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand cite
key "X.680"
literal "false"

\end_inset

 schema is provided in Appendix
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "sec:ASN.1-Schema"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
\end_layout

\begin_layout Subsubsection
SeedDescriptor fields
\begin_inset CommandInset label
LatexCommand label
name "subsec:SeedDescriptor-fields"

\end_inset


\end_layout

\begin_layout Standard
The 
\series bold
SeedDescriptor
\series default
 data object is defined by the ASN.1
\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand cite
key "X.680"
literal "false"

\end_inset

 schema fragment:
\end_layout

\begin_layout Standard
\begin_inset CommandInset include
LatexCommand inputminted
filename "cx-seeddescriptor.asn1"
lstparams "language=Clean"

\end_inset


\end_layout

\begin_layout Paragraph
signatureAlgorithm
\begin_inset CommandInset label
LatexCommand label
name "par:SeedDescriptor-signatureAlgorithm"

\end_inset


\end_layout

\begin_layout Standard
The 
\series bold
signatureAlgorithm
\series default
 field contains the X.509
\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand cite
key "RFC5280"
literal "false"

\end_inset

 
\series bold
AlgorithmIdentifier
\series default
 which comprises the object identifier (OID) and optional parameters for
 the algorithm used to generate the corresponding signature in the 
\series bold
signatureValues
\series default
 field (see section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "par:SeedReport-signatureValues"
plural "false"
caps "false"
noprefix "false"

\end_inset

).
\end_layout

\begin_layout Standard
An Advertiser SHALL set this field to the algorithm used to compute the
 corresponding signature in the 
\series bold
signatureValues
\series default
 field, and the algorithm SHALL be compatible with the public key algorithm
 provided in the 
\series bold
preseedVerificationKey
\series default
 field.
\end_layout

\begin_layout Standard
A Publisher SHALL verify that the algorithm specified in this field is compatibl
e with the public key algorithm provided in the 
\series bold
preseedVerificationKey
\series default
 field.
\end_layout

\begin_layout Paragraph
generatorType
\begin_inset CommandInset label
LatexCommand label
name "par:SeedDescriptor-generatorType"

\end_inset


\end_layout

\begin_layout Standard
\begin_inset CommandInset include
LatexCommand inputminted
filename "cx-generatortype.asn1"
lstparams "language=Clean"

\end_inset


\end_layout

\begin_layout Standard
The 
\series bold
generatorType
\series default
 field contains the Generator Type as defined in section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Generator-Types"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
\end_layout

\begin_layout Paragraph
preseedValue
\begin_inset CommandInset label
LatexCommand label
name "par:SeedDescriptor-preseedValue"

\end_inset


\end_layout

\begin_layout Standard
The 
\series bold
preseedValue
\series default
 field contains the Preseed Value encoded as an OCTET STRING of the Seed
 Length specified for the Generator Type in section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Generator-Types"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
\end_layout

\begin_layout Paragraph
preseedVerificationKey
\begin_inset CommandInset label
LatexCommand label
name "par:SeedDescriptor-preseedVerificationKey"

\end_inset


\end_layout

\begin_layout Standard
The 
\series bold
preseedVerificationKey
\series default
 field contains the X.509
\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand cite
key "RFC5280"
literal "false"

\end_inset

 
\series bold
SubjectPublicKeyInfo
\series default
 which comprises the algorithm object identifier (OID), optional algorithm
 parameters, and the public key of the Preseed Verification Key.
\end_layout

\begin_layout Standard
An Advertiser SHALL set this field to the same ASN.1
\begin_inset space ~
\end_inset

DER
\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand cite
key "X.690"
literal "false"

\end_inset

 encoded value as used for Seed Calculator instantiation as defined in section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Seed-Calculator-Instantiation"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
\end_layout

\begin_layout Standard
A Publisher SHALL verify that the algorithm specified in this field is compatibl
e with the signature algorithm specified in the 
\series bold
signatureAlgorithm
\series default
 field.
\end_layout

\begin_layout Subsubsection
TBSSeedReport fields
\begin_inset CommandInset label
LatexCommand label
name "subsec:TBSSeedReport-fields"

\end_inset


\end_layout

\begin_layout Standard
The 
\series bold
TBSSeedReport
\series default
 data object is defined by the ASN.1
\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand cite
key "X.680"
literal "false"

\end_inset

 schema fragment:
\end_layout

\begin_layout Standard
\begin_inset CommandInset include
LatexCommand inputminted
filename "cx-tbsseedreport.asn1"
lstparams "language=Clean"

\end_inset


\end_layout

\begin_layout Paragraph
version
\begin_inset CommandInset label
LatexCommand label
name "par:TBSSeedReport-version"

\end_inset


\end_layout

\begin_layout Standard
\begin_inset CommandInset include
LatexCommand inputminted
filename "cx-seedreportversion.asn1"
lstparams "language=Clean"

\end_inset


\end_layout

\begin_layout Standard
The 
\series bold
version
\series default
 field describes the version of the 
\series bold
SeedDescriptor,
\series default
 
\series bold
TBSSeedReport
\series default
 and 
\series bold
SeedReport
\series default
 structures.
 In the present specification, only a single version is defined.
\end_layout

\begin_layout Standard
An Advertiser SHALL set this field to version 1.
\end_layout

\begin_layout Standard
A Publisher SHALL accept any value in this field, and SHALL silently accept
 and ignore any unrecognised additional fields present in the 
\series bold
SeedDescriptor 
\series default
structure following the 
\series bold
preseedVerificationKey
\series default
 field or in the 
\series bold
TBSSeedReport
\series default
 structure following the 
\series bold
seedReportChallenge
\series default
 field.
\end_layout

\begin_layout Paragraph
seedDescriptors
\begin_inset CommandInset label
LatexCommand label
name "par:TBSSeedReport-seedDescriptors"

\end_inset


\end_layout

\begin_layout Standard
\begin_inset CommandInset include
LatexCommand inputminted
filename "cx-seeddescriptor--seeddescriptors.asn1"
lstparams "language=Clean"

\end_inset


\end_layout

\begin_layout Standard
The 
\series bold
seedDescriptors
\series default
 field contains an arbitrarily ordered list of 
\series bold
SeedDescriptor
\series default
 data objects.
 Each 
\series bold
SeedDescriptor
\series default
 contains a signature algorithm, a Generator Type, a Preseed Value, and
 a Preseed Verification Key.
 The layout of the 
\series bold
SeedDescriptor
\series default
 data object is defined in section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:SeedDescriptor-fields"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
\end_layout

\begin_layout Standard
A Publisher SHALL accept a Seed Report containing one or more correctly
 signed 
\series bold
SeedDescriptor
\series default
 data objects that have been used in a previously received Seed Report.
\end_layout

\begin_layout Standard
When determining the Alert Level to associate with a Seed Value (see section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Seed-Report-Challenges"
plural "false"
caps "false"
noprefix "false"

\end_inset

), the Publisher SHALL use the most recently issued (rather than most recently
 received) Confirmation Code present in a correctly signed 
\series bold
SeedDescriptor
\series default
 data object for that Seed Value.
 This is necessary in order to prevent Seed Report replay attacks.
\end_layout

\begin_layout Paragraph
publisherName
\begin_inset CommandInset label
LatexCommand label
name "par:TBSSeedReport-publisherName"

\end_inset


\end_layout

\begin_layout Standard
The 
\series bold
publisherName
\series default
 field contains the Publisher Name for the Publisher to which the Advertiser
 intends to upload the Seed Report.
 This field exists solely to create a namespace for Seed Report Challenges,
 and thereby to reduce the scope for collision attacks on Seed Report Challenge
 values, which are necessarily low-entropy since they must be communicated
 accurately by humans.
\end_layout

\begin_layout Standard
An Advertiser SHALL set this field to the Publisher Name as specified in
 the 
\series bold
name
\series default
 field of the Publisher Description for the intended Publisher as defined
 in section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Publisher-name"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
\end_layout

\begin_layout Standard
A Publisher SHALL verify that this field contains its own Publisher Name.
 Since this is a human-writable text field, a Publisher MAY choose to allow
 for some expected variations in the Publisher Name, such as variations
 in casing, punctuation, or whitespace.
\end_layout

\begin_layout Paragraph
seedReportChallenge
\begin_inset CommandInset label
LatexCommand label
name "par:TBSSeedReport-seedReportChallenge"

\end_inset


\end_layout

\begin_layout Standard
The 
\series bold
seedReportChallenge
\series default
 field contains a Confirmation Code generated by the Publisher and conveyed
 to the Advertiser via an out-of-band mechanism; see section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Seed-Report-Challenges"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
\end_layout

\begin_layout Standard
An Advertiser SHALL set this field to the Confirmation Code value provided
 via the out-of-band mechanism (such as interactive entry via a user interface
 on the Advertiser Device).
\end_layout

\begin_layout Standard
An Advertiser MAY choose to upload future Seed Reports using the same Confirmati
on Code but with additional Preseed Values and Preseed Verification Keys.
\end_layout

\begin_layout Standard
A Publisher SHALL verify that this field contains a recognised Confirmation
 Code value that is either:
\end_layout

\begin_layout Itemize
Sufficiently recently created and never previously used in a Seed Report,
 or
\end_layout

\begin_layout Itemize
Sufficiently recently created and previously used in a Seed Report that
 was successfully verified using the Preseed Verification Key present in
 the 
\series bold
preseedVerificationKey
\series default
 field of at least one element of the 
\series bold
seedDescriptors
\series default
 list.
\end_layout

\begin_layout Standard
In both cases, the Publisher SHALL define and apply its own rules in defining
 the amount of elapsed time that is considered to be sufficiently recent.
 In doing so, the Publisher SHOULD consider the duration for which the diagnosis
 associated with the Confirmation Code remains applicable.
\end_layout

\begin_layout Standard
Since this is a human-writable text field, a Publisher MAY choose to allow
 for some expected variations in the Confirmation Code, such as variations
 in casing, punctuation, or whitespace.
\end_layout

\begin_layout Paragraph
extensions
\begin_inset CommandInset label
LatexCommand label
name "par:TSSeedReport-extensions"

\end_inset


\end_layout

\begin_layout Standard
\begin_inset CommandInset include
LatexCommand inputminted
filename "cx-extension--extensions.asn1"
lstparams "language=Clean"

\end_inset


\end_layout

\begin_layout Standard
The 
\series bold
extensions
\series default
 field contains OPTIONAL extensions defined outside the scope of this specificat
ion document.
 This field exists to support additional information that is not applicable
 to all Advertisers and Publishers.
 The layout of each extension comprises an extension identifier 
\series bold
extnID
\series default
 followed by fields as defined by that extension identifier.
\end_layout

\begin_layout Standard
An Advertiser MAY choose to include an 
\series bold
extensions
\series default
 field.
\end_layout

\begin_layout Standard
A Publisher MAY choose to interpret the contents of the 
\series bold
extensions
\series default
 field, and MAY choose to document extensions that should be included in
 Seed Reports uploaded to that Publisher.
 A Publisher SHALL silently accept and ignore any extension that it does
 not recognise.
 A Publisher SHALL accept and process a Seed Report that omits a particular
 extension, or that omits the 
\series bold
extensions
\series default
 field entirely.
 A Publisher SHALL NOT require that Advertisers include any particular extension
 in a Seed Report.
\end_layout

\begin_layout Subsubsection
SeedReport fields
\begin_inset CommandInset label
LatexCommand label
name "subsec:SeedReport-fields"

\end_inset


\end_layout

\begin_layout Standard
The 
\series bold
SeedReport
\series default
 data object is defined by the ASN.1
\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand cite
key "X.680"
literal "false"

\end_inset

 schema fragment:
\end_layout

\begin_layout Standard
\begin_inset CommandInset include
LatexCommand inputminted
filename "cx-seedreport.asn1"
lstparams "language=Clean"

\end_inset


\end_layout

\begin_layout Paragraph
tbsSeedReport
\begin_inset CommandInset label
LatexCommand label
name "par:SeedReport-tbsSeedReport"

\end_inset


\end_layout

\begin_layout Standard
The 
\series bold
tbsSeedReport
\series default
 field contains a 
\series bold
TBSSeedReport
\series default
 data object.
 The 
\series bold
TBSSeedReport 
\series default
contains the Generator Types, Preseed Values, Preseed Verification Keys,
 Seed Report Challenge, and other information.
 It exists as a separate field since the 
\series bold
signatureValues
\series default
 are calculated over the ASN.1
\begin_inset space ~
\end_inset

DER
\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand cite
key "X.690"
literal "false"

\end_inset

 encoding of this field.
 The layout of the 
\series bold
TBSSeedReport
\series default
 data object is defined in section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:TBSSeedReport-fields"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
\end_layout

\begin_layout Paragraph
signatureValues
\begin_inset CommandInset label
LatexCommand label
name "par:SeedReport-signatureValues"

\end_inset


\end_layout

\begin_layout Standard
\begin_inset CommandInset include
LatexCommand inputminted
filename "cx-signaturevalue--signaturevalues.asn1"
lstparams "language=Clean"

\end_inset


\end_layout

\begin_layout Standard
The 
\series bold
signatureValues
\series default
 field contains an ordered list of 
\series bold
SignatureValue
\series default
 data objects, matching the length and ordering of the list in the 
\series bold
seedDescriptors
\series default
 field as defined in section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "par:TBSSeedReport-seedDescriptors"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
 Each element in this list contains a digital signature computed upon the
 ASN.1
\begin_inset space ~
\end_inset

DER
\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand cite
key "X.690"
literal "false"

\end_inset

 encoded 
\series bold
tbsSeedReport
\series default
 using the Preseed Signing Key matching the 
\series bold
preseedVerificationKey 
\series default
of the correspondingly positioned element within the 
\series bold
seedDescriptors
\series default
 list.
\end_layout

\begin_layout Standard
For each ordered element in the 
\series bold
seedDescriptors
\series default
 list, an Advertiser SHALL compute the corresponding 
\series bold
SignatureValue
\series default
 using the algorithm specified by the 
\series bold
signatureAlgorithm
\series default
 field (see section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "par:SeedDescriptor-signatureAlgorithm"
plural "false"
caps "false"
noprefix "false"

\end_inset

) with the input data being the ASN.1
\begin_inset space ~
\end_inset

DER
\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand cite
key "X.690"
literal "false"

\end_inset

 encoding of 
\series bold
tbsSeedReport
\series default
 (including the initial SEQUENCE tag byte) and the signing key being the
 Preseed Signing Key corresponding to the 
\series bold
preseedVerificationKey
\series default
 field.
\end_layout

\begin_layout Standard
For each ordered element in the 
\series bold
seedDescriptors
\series default
 list,
\series bold
 
\series default
a Publisher SHALL verify the corresponding 
\series bold
SignatureValue
\series default
 using the algorithm specified by the 
\series bold
signatureAlgorithm
\series default
 field (see section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "par:SeedDescriptor-signatureAlgorithm"
plural "false"
caps "false"
noprefix "false"

\end_inset

) with the input data being the ASN.1
\begin_inset space ~
\end_inset

DER
\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand cite
key "X.690"
literal "false"

\end_inset

 encoding of 
\series bold
tbsSeedReport
\series default
 (including the initial SEQUENCE tag byte) and the verification key being
 the Preseed Verification Key extracted from the 
\series bold
preseedVerificationKey
\series default
 field (see section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "par:SeedDescriptor-preseedVerificationKey"
plural "false"
caps "false"
noprefix "false"

\end_inset

).
 A Publisher SHALL reject a Seed Report that fails signature verification
 for any element in the 
\series bold
seedDescriptors 
\series default
list and, where possible, SHALL return an error to the Advertiser indicating
 that a signature was incorrect.
\end_layout

\begin_layout Section
Publications
\begin_inset CommandInset label
LatexCommand label
name "sec:Publications"

\end_inset


\end_layout

\begin_layout Standard
A Publication is a message constructed by a Publisher to be sent to Observers
 or to other Publishers.
 The Publication is used to communicate a set of Notifications.
\end_layout

\begin_layout Standard
A Publication is initially retrieved (by an Observer or another Publisher)
 from a Publication Endpoint as defined in section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Publication-Endpoint"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
\end_layout

\begin_layout Standard
To reduce bandwidth consumption, a Publisher MAY choose to publish a set
 of concurrent Publications covering an identical underlying logical set
 of Notifications but where the 
\series bold
excludesPublishedBefore
\series default
 field (see section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "par:TBSPublicationData-excludesPublishedBefore"
plural "false"
caps "false"
noprefix "false"

\end_inset

) is used to elide Notifications that have already been received as part
 of a prior Publication.
 An overview of this bandwidth compression mechanism is given in section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Publication-Bandwidth-Compression"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
\end_layout

\begin_layout Subsection
Publication Algorithms
\begin_inset CommandInset label
LatexCommand label
name "subsec:Publication-Algorithms"

\end_inset


\end_layout

\begin_layout Standard
A Publisher SHALL use the construction algorithm defined in section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Publication-Construction"
plural "false"
caps "false"
noprefix "false"

\end_inset

 to construct a Publication for distribution to Observers to or other Publishers.
 A Publisher SHALL use the verification algorithm defined in section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Publication-Interpretation"
plural "false"
caps "false"
noprefix "false"

\end_inset

 to verify a Publication received from another Publisher prior to processing
 the Notifications.
\end_layout

\begin_layout Standard
A Observer SHALL use the interpretation algorithm defined in section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Publication-Interpretation"
plural "false"
caps "false"
noprefix "false"

\end_inset

 to interpret a Publication prior to processing the Notifications.
\end_layout

\begin_layout Standard
An Advertiser has no need for the algorithms defined in this section since
 Advertisers do not construct Publications.
\end_layout

\begin_layout Subsubsection
Publication Construction Algorithm
\begin_inset CommandInset label
LatexCommand label
name "subsec:Publication-Construction"

\end_inset


\end_layout

\begin_layout Standard
The algorithm comprises 2 steps:
\end_layout

\begin_layout Enumerate
Construct a 
\series bold
TBSPublicationData
\series default
 data object as defined in section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:TBSPublicationData-fields"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
\end_layout

\begin_layout Enumerate
Construct a digitally signed CMS
\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand cite
key "RFC5652"
literal "false"

\end_inset

 message in the form of a 
\series bold
PublicationContentInfo
\series default
 data object incorporating the 
\series bold
TBSPublicationData
\series default
 as defined in section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:PublicationContentInfo-fields"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
\end_layout

\begin_layout Subsubsection
Publication Interpretation Algorithm
\begin_inset CommandInset label
LatexCommand label
name "subsec:Publication-Interpretation"

\end_inset


\end_layout

\begin_layout Standard
The algorithm comprises 2 steps:
\end_layout

\begin_layout Enumerate
Verify that the CMS
\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand cite
key "RFC5652"
literal "false"

\end_inset

 message includes a valid signature by a valid Publisher Certificate correspondi
ng to the identity of the Publisher, and is in the form of a valid 
\series bold
PublicationContentInfo
\series default
 data object as defined in section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:PublicationContentInfo-fields"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
\end_layout

\begin_layout Enumerate
Interpret the encapsulated message content as a 
\series bold
TBSPublicationData
\series default
 data object as defined in section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:TBSPublicationData-fields"
plural "false"
caps "false"
noprefix "false"

\end_inset


\end_layout

\begin_layout Subsection
Publication Layout
\begin_inset CommandInset label
LatexCommand label
name "subsec:Publication-Layout"

\end_inset


\end_layout

\begin_layout Standard
A Publication is the ASN.1
\begin_inset space ~
\end_inset

DER
\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand cite
key "X.690"
literal "false"

\end_inset

 encoding of a 
\series bold
PublicationContentInfo
\series default
 data object as defined in section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:PublicationContentInfo-fields"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
 A full ASN.1
\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand cite
key "X.680"
literal "false"

\end_inset

 schema is provided in Appendix
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "sec:ASN.1-Schema"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
\end_layout

\begin_layout Subsubsection
Notification fields
\begin_inset CommandInset label
LatexCommand label
name "subsec:Notification-fields"

\end_inset


\end_layout

\begin_layout Standard
The 
\series bold
Notification
\series default
 data object is defined by the ASN.1
\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand cite
key "X.680"
literal "false"

\end_inset

 schema fragment:
\end_layout

\begin_layout Standard
\begin_inset CommandInset include
LatexCommand inputminted
filename "cx-notification.asn1"
lstparams "language=Clean"

\end_inset


\end_layout

\begin_layout Paragraph
alertLevel
\begin_inset CommandInset label
LatexCommand label
name "par:Notification-alertLevel"

\end_inset


\end_layout

\begin_layout Standard
\begin_inset CommandInset include
LatexCommand inputminted
filename "cx-alertlevel.asn1"
lstparams "language=Clean"

\end_inset


\end_layout

\begin_layout Standard
The 
\series bold
alertLevel
\series default
 field contains the most recent Alert Level associated by the Publisher
 with the Seed Values in the 
\series bold
seedValues
\series default
 field.
 To reduce bandwidth consumption, this field applies to a set of Seed Values
 rather than being specified individually for each Seed Value.
\end_layout

\begin_layout Standard
When constructing a Publication, a Publisher SHALL set this field to indicate
 the most recent Alert Level associated by the Publisher with the Seed Values
 in the 
\series bold
seedValues
\series default
 field.
\end_layout

\begin_layout Standard
When interpreting a Publication, a Publisher SHALL accept any unrecognised
 
\series bold
alertLevel
\series default
 values and SHALL propagate these 
\series bold
alertLevel
\series default
 values verbatim into any derived Publications that it constructs from this
 Publication.
\end_layout

\begin_layout Standard
When interpreting a Publication, an Observer SHALL treat any unrecognised
 
\series bold
alertLevel
\series default
 values as equivalent to 
\series bold
unknown-alert(3)
\series default
.
\end_layout

\begin_layout Paragraph
generatorType
\begin_inset CommandInset label
LatexCommand label
name "par:Notification-generatorType"

\end_inset


\end_layout

\begin_layout Standard
\begin_inset CommandInset include
LatexCommand inputminted
filename "cx-generatortype.asn1"
lstparams "language=Clean"

\end_inset


\end_layout

\begin_layout Standard
The 
\series bold
generatorType
\series default
 field contains the Generator Type as defined in section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Generator-Types"
plural "false"
caps "false"
noprefix "false"

\end_inset

 for the Seed Values in the 
\series bold
seedValues
\series default
 field.
 To reduce bandwidth consumption, this field applies to a set of Seed Values
 rather than being specified individually for each Seed Value.
\end_layout

\begin_layout Standard
When constructing a Publication, a Publisher SHALL set this field to indicate
 the Generator Type for the Seed Values in the 
\series bold
seedValues
\series default
 field.
\end_layout

\begin_layout Paragraph
seedValues
\begin_inset CommandInset label
LatexCommand label
name "par:Notification-seedValues"

\end_inset


\end_layout

\begin_layout Standard
\begin_inset CommandInset include
LatexCommand inputminted
filename "cx-seedvalues.asn1"
lstparams "language=Clean"

\end_inset


\end_layout

\begin_layout Standard
The 
\series bold
seedValues
\series default
 field contains the arbitrarily ordered and concatenated Seed Values for
 the combination of 
\series bold
alertLevel
\series default
 and 
\series bold
generatorType
\series default
.
 To reduce bandwidth consumption, this field is a single OCTET STRING containing
 a concatenation of the Seed Values, rather than a SEQUENCE OF OCTET STRING
 where each OCTET STRING contains a single Seed Value.
 The length of each individual Seed Value is the Seed Length specified for
 the Generator Type in section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Generator-Types"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
\end_layout

\begin_layout Standard
When constructing a Publication, a Publisher SHALL set this field to an
 arbitrarily ordered concatenation of the relevant Seed Values for the Alert
 Level in the 
\series bold
alertLevel
\series default
 field and the Generator Type in the 
\series bold
generatorType
\series default
 field.
\end_layout

\begin_layout Subsubsection
TBSPublicationData fields
\begin_inset CommandInset label
LatexCommand label
name "subsec:TBSPublicationData-fields"

\end_inset


\end_layout

\begin_layout Standard
The 
\series bold
TBSPublicationData
\series default
 data object is defined by the ASN.1
\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand cite
key "X.680"
literal "false"

\end_inset

 schema fragment:
\end_layout

\begin_layout Standard
\begin_inset CommandInset include
LatexCommand inputminted
filename "cx-tbspublicationdata.asn1"
lstparams "language=Clean"

\end_inset


\end_layout

\begin_layout Paragraph
version
\begin_inset CommandInset label
LatexCommand label
name "par:TBSPublicationData-version"

\end_inset


\end_layout

\begin_layout Standard
\begin_inset CommandInset include
LatexCommand inputminted
filename "cx-publicationversion.asn1"
lstparams "language=Clean"

\end_inset


\end_layout

\begin_layout Standard
The 
\series bold
version
\series default
 field describes the version of the 
\series bold
TBSPublicationData
\series default
 structure.
 In the present specification, only a single version is defined.
\end_layout

\begin_layout Standard
When constructing a Publication, a Publisher SHALL set this field to version
 1.
\end_layout

\begin_layout Standard
When interpreting a Publication, an Observer or Publisher SHALL accept any
 value in this field, and SHALL silently accept and ignore any unrecognised
 additional fields present in the 
\series bold
TBSPublicationData
\series default
 structure following the
\series bold
 updateURLs
\series default
 field.
\end_layout

\begin_layout Paragraph
intendedAudience
\begin_inset CommandInset label
LatexCommand label
name "par:TBSPublicationData-intendedAudience"

\end_inset


\end_layout

\begin_layout Standard
\begin_inset CommandInset include
LatexCommand inputminted
filename "cx-publicationaudience.asn1"
lstparams "language=Clean"

\end_inset


\end_layout

\begin_layout Standard
The 
\series bold
intendedAudience
\series default
 field describes the intended audience for the Publication as one of the
 following values:
\end_layout

\begin_layout Description
observer(1) The Publication is intended to be consumed by Observers and
 includes all Notifications that are known to be relevant to Observers subscribi
ng to the Publisher, including relevant Notifications that originated from
 other Publishers.
\end_layout

\begin_layout Description
publisher(2) The Publication is intended to be consumed by another Publisher
 and contains only Notifications that are relevant to the consuming Publisher.
\end_layout

\begin_layout Standard
This field exists primarily to detect misconfigurations.
\end_layout

\begin_layout Standard
When constructing a Publication, a Publisher SHALL set this field to indicate
 the intended audience, based on the subset of Notifications that the Publisher
 is including within this Publication.
\end_layout

\begin_layout Standard
When interpreting a Publication, an Observer SHALL treat a Publication as
 invalid if this field contains any value other than 
\series bold
observer(1)
\series default
.
\end_layout

\begin_layout Standard
When interpreting a Publication, an Publisher SHALL treat a Publication
 as invalid if this field contains any value other than 
\series bold
publisher(2)
\series default
.
\end_layout

\begin_layout Paragraph
publishedAt
\begin_inset CommandInset label
LatexCommand label
name "par:TBSPublicationData-publishedAt"

\end_inset


\end_layout

\begin_layout Standard
The 
\series bold
publishedAt
\series default
 field contains the time at which the Publisher created this version of
 the Publication.
 The value of this field MUST increase monotonically for new versions of
 this Publication from a given Publisher.
 The value of this field MAY be consistent between different Publishers.
\end_layout

\begin_layout Standard
When constructing a Publication, a Publisher SHALL set this field to its
 notion of the current time, SHALL express the GeneralizedTime value using
 an explicit UTC
\begin_inset space ~
\end_inset

(
\begin_inset Quotes eld
\end_inset

Z
\begin_inset Quotes erd
\end_inset

) time zone, and SHALL ensure that the value of this field is strictly later
 than the value of all prior versions of this Publication.
\end_layout

\begin_layout Standard
When interpreting a Publication, an Observer or Publisher SHALL record the
 
\series bold
publishedAt
\series default
 time of a successfully verified and processed Publication, and SHALL treat
 a Publication as invalid if the 
\series bold
publishedAt
\series default
 field contains a time that is strictly earlier than the recorded 
\series bold
publishedAt
\series default
 time for another version of this Publication.
\end_layout

\begin_layout Paragraph
nextUpdateNotBefore
\begin_inset CommandInset label
LatexCommand label
name "par:TBSPublicationData-nextUpdateNotBefore"

\end_inset


\end_layout

\begin_layout Standard
The 
\series bold
nextUpdateNotBefore
\series default
 field contains the Publisher's estimate of the earliest time that it will
 publish a new version of this Publication.
 This field is informative only and MAY be used by the Publisher to suggest
 a rate limit on requests from Observers or from other Publishers.
\end_layout

\begin_layout Standard
When constructing a Publication, a Publisher SHALL set this field to an
 estimate of the time that it expects to publish a new version of this Publicati
on, and SHALL express the GeneralizedTime value using an explicit UTC
\begin_inset space ~
\end_inset

(
\begin_inset Quotes eld
\end_inset

Z
\begin_inset Quotes erd
\end_inset

) time zone.
\end_layout

\begin_layout Standard
When interpreting a Publication, an Observer or Publisher SHOULD record
 the 
\series bold
nextUpdateNotBefore
\series default
 field of a successfully verified and processed Publication and SHOULD NOT
 attempt to retrieve a new version of the Publication prior to the time
 expressed in the 
\series bold
nextUpdateNotBefore
\series default
 field.
 The Observer or Publisher SHALL add a suitable random delay to its locally
 scheduled retrieval time and SHALL NOT schedule the retrieval for the exact
 time specified in the 
\series bold
nextUpdateNotBefore
\series default
 field.
 The Observer or Publisher SHALL disregard the contents of any 
\series bold
nextUpdateNotBefore
\series default
 field that contains a time greater than 24 hours in the future.
\end_layout

\begin_layout Paragraph
nextUpdateNotAfter
\begin_inset CommandInset label
LatexCommand label
name "par:TBSPublicationData-nextUpdateNotAfter"

\end_inset


\end_layout

\begin_layout Standard
The 
\series bold
nextUpdateNotAfter
\series default
 field contains the time by which the Publisher guarantees to have published
 a new version of this Publication.
 This field is used to detect and disregard stale versions of Publications.
\end_layout

\begin_layout Standard
When constructing a Publication, a Publisher SHALL set this field to a time
 before which it SHALL publish a new version of this Publication, and SHALL
 express the GeneralizedTime value using an explicit UTC
\begin_inset space ~
\end_inset

(
\begin_inset Quotes eld
\end_inset

Z
\begin_inset Quotes erd
\end_inset

) time zone.
 The Publisher SHALL publish a new version of the Publication before this
 time, even if the new verison of the Publication contains no new Notifications.
\end_layout

\begin_layout Standard
When interpreting a Publication, an Observer or Publisher SHALL treat the
 Publication as invalid if the 
\series bold
publishedAt
\series default
 field contains a time that is the same as a previously recorded 
\series bold
publishedAt
\series default
 time for this Publication and the 
\series bold
nextUpdateNotAfter
\series default
 field contains a time that is in the past.
\end_layout

\begin_layout Paragraph
excludesPublishedBefore
\begin_inset CommandInset label
LatexCommand label
name "par:TBSPublicationData-excludesPublishedBefore"

\end_inset


\end_layout

\begin_layout Standard
The OPTIONAL 
\series bold
excludesPublishedBefore
\series default
 field contains a time indicating Seed Values that have been elided from
 the Publication.
 Any Seed Values that were previously published with the same Alert Level
 in a version of the Publication with a 
\series bold
publishedAt
\series default
 time earlier than 
\series bold
excludesPublishedBefore
\series default
 are elided from this version of the Publication.
\end_layout

\begin_layout Standard
Note that Publishers MUST publish at least one Publication that includes
 the full set of non-expired Seed Values and has no 
\series bold
excludesPublishedBefore
\series default
 field, as specified in section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Publication-Bandwidth-Compression"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
\end_layout

\begin_layout Standard
When constructing a Publication utilising bandwidth compression as described
 in section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Publication-Bandwidth-Compression"
plural "false"
caps "false"
noprefix "false"

\end_inset

, a Publisher MAY set this field to a time earlier than the 
\series bold
publishedAt
\series default
 time.
 If a Publisher does this, it SHALL omit from the Notification any Seed
 Values that were previously published with the same Alert Level in a version
 of this Publication with a 
\series bold
publishedAt
\series default
 time that is strictly earlier than this field.
\end_layout

\begin_layout Standard
When interpreting a Publication, an Observer or Publisher SHALL treat the
 Publication as invalid if the 
\series bold
excludesPublishedBefore
\series default
 field contains a time that is not strictly earlier than the most recently
 recorded 
\series bold
publishedAt
\series default
 time for this Publication.
\end_layout

\begin_layout Paragraph
notifications
\begin_inset CommandInset label
LatexCommand label
name "par:TBSPublicationData-notifications"

\end_inset


\end_layout

\begin_layout Standard
\begin_inset CommandInset include
LatexCommand inputminted
filename "cx-notification--notifications.asn1"
lstparams "language=Clean"

\end_inset


\end_layout

\begin_layout Standard
The 
\series bold
notifications
\series default
 field contains an arbitrarily ordered list of 
\series bold
Notification
\series default
 data objects.
 Each 
\series bold
Notification
\series default
 contains an Alert Level, a Generator Type, and an arbitrarily ordered set
 of Seed Values.
 The layout of the 
\series bold
Notification
\series default
 data object is defined in section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Notification-fields"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
\end_layout

\begin_layout Standard
When constructing a Publication, a Publisher SHOULD ensure that at most
 one 
\series bold
Notification
\series default
 data object exists per combination of 
\series bold
alertLevel 
\series default
and 
\series bold
generatorType
\series default
 within the Publication.
 If the 
\series bold
excludesPublishedBefore
\series default
 field is not present in the Publication, then the Publisher SHALL NOT include
 a 
\series bold
Notification
\series default
 data object with an 
\series bold
alertLevel
\series default
 set to 
\series bold
expired
\series default
.
\end_layout

\begin_layout Standard
When constructing a Publication, a Publisher SHALL ensure that each combination
 of Generator Type and Seed Value appears at most once within the Publication.
\end_layout

\begin_layout Standard
When interpreting a Publication where the 
\series bold
excludesPublishedBefore
\series default
 field is not present, an Observer or Publisher SHALL assume that any Seed
 Values included in earlier versions of the Publication but not included
 in this Publication have an Alert Level of 
\series bold
expired
\series default
.
\end_layout

\begin_layout Standard
Note that a zero-length SEQUENCE is a valid value for this field.
\end_layout

\begin_layout Paragraph
updateURLs
\begin_inset CommandInset label
LatexCommand label
name "par:TBSPublicationData-updateURLs"

\end_inset


\end_layout

\begin_layout Standard
\begin_inset CommandInset include
LatexCommand inputminted
filename "cx-updateurl--updateurls.asn1"
lstparams "language=Clean"

\end_inset


\end_layout

\begin_layout Standard
The 
\series bold
updateURLs
\series default
 field contains a preference-ordered list of 
\series bold
UpdateURL
\series default
 data objects.
 Each 
\series bold
UpdateURL 
\series default
is a Uniform Resource Locator (URLs) to be used for retrieving new versions
 of the Publication, with the first list element being the first preference
 URL.
\end_layout

\begin_layout Standard
When constructing a Publication, a Publisher MAY set this field to an ordered
 list of URLs to be used for retrieving new versions of the Publication
 as described in section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Publication-Bandwidth-Compression"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
 If the Publisher does this, it SHALL ensure that all URLs within the list
 are absolute URLs.
\end_layout

\begin_layout Standard
When interpreting a Publication, an Observer or Publisher SHOULD record
 the 
\series bold
updateURLs
\series default
 field of a successfully verified and processed Publication and SHOULD attempt
 to retrieve the next version of the Publication from each URL within the
 
\series bold
updateURLs 
\series default
list before attempting to retrieve the next version of the Publication from
 the original Publication URL.
 If an Observer or Publisher does this, it SHALL treat any verification
 or validation failure as equivalent to a failed retrieval, and move to
 the next URL in the list (or to the original Publication URL, if there
 are no entries remaining).
\end_layout

\begin_layout Standard
Note that a zero-length SEQUENCE is a valid value for this field.
\end_layout

\begin_layout Paragraph
extensions
\begin_inset CommandInset label
LatexCommand label
name "par:TBSPublicationData-extensions"

\end_inset


\end_layout

\begin_layout Standard
\begin_inset CommandInset include
LatexCommand inputminted
filename "cx-extension--extensions.asn1"
lstparams "language=Clean"

\end_inset


\end_layout

\begin_layout Standard
The 
\series bold
extensions
\series default
 field contains OPTIONAL extensions defined outside the scope of this specificat
ion document.
 This field exists to support additional information that is not applicable
 to all Publishers and Observers.
 The layout of each extension comprises an extension identifier 
\series bold
extnID
\series default
 followed by fields as defined by that extension identifier.
\end_layout

\begin_layout Standard
When constructing a Publication, a Publisher MAY choose to include an 
\series bold
extensions
\series default
 field.
\end_layout

\begin_layout Standard
When interpreting a Publication, an Observer or Publisher MAY choose to
 interpret the contents of the 
\series bold
extensions
\series default
 field.
 If the Observer or Publisher does this, it SHALL silently accept and ignore
 any extension that it does not recognise.
\end_layout

\begin_layout Subsubsection
PublicationContentInfo fields
\begin_inset CommandInset label
LatexCommand label
name "subsec:PublicationContentInfo-fields"

\end_inset


\end_layout

\begin_layout Standard
The 
\series bold
PublicationContentInfo
\series default
 data object is defined by the ASN.1
\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand cite
key "X.680"
literal "false"

\end_inset

 schema fragment:
\end_layout

\begin_layout Standard
\begin_inset CommandInset include
LatexCommand inputminted
filename "cx-id-ct-cx-publicationdata--publicationcontentinfo.asn1"
lstparams "language=Clean"

\end_inset


\end_layout

\begin_layout Standard
The 
\series bold
ContentInfo
\series default
 type is defined by RFC
\begin_inset space ~
\end_inset

5652
\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand cite
key "RFC5652"
literal "false"

\end_inset

.
\end_layout

\begin_layout Standard
When constructing a Publication, a Publisher SHALL construct this data object
 as specified in RFC
\begin_inset space ~
\end_inset

5652
\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand cite
key "RFC5652"
literal "false"

\end_inset

 with the 
\series bold
contentType
\series default
 set to 
\series bold
id-signedData
\series default
, the 
\series bold
eContentType
\series default
 set to 
\series bold
id-ct-cx-publicationData
\series default
, the 
\series bold
eContent
\series default
 OCTET STRING contents set to the ASN.1
\begin_inset space ~
\end_inset

DER
\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand cite
key "X.690"
literal "false"

\end_inset

 encoding of a 
\series bold
TBSPublicationData
\series default
 data object as defined by section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:TBSPublicationData-fields"
plural "false"
caps "false"
noprefix "false"

\end_inset

, and with a valid digital signature created using the Publisher Signing
 Key and the Publisher Certificate as provided in the Publisher Descriptor
 (see section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Publisher-cert"
plural "false"
caps "false"
noprefix "false"

\end_inset

).
\end_layout

\begin_layout Standard
When interpreting a Publication, an Observer or Publisher SHALL verify that
 the 
\series bold
contentType
\series default
 is set to 
\series bold
id-signedData
\series default
 and that at least one digital signature is correct and matches the Publisher
 Certificate obtained from the Publisher Descriptor (see section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Publisher-cert"
plural "false"
caps "false"
noprefix "false"

\end_inset

), and SHALL then interpret the contents of the 
\series bold
eContent
\series default
 OCTET STRING as the ASN.1
\begin_inset space ~
\end_inset

DER
\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand cite
key "X.690"
literal "false"

\end_inset

 encoding of a 
\series bold
TBSPublicationData
\series default
 data object as defined by section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:TBSPublicationData-fields"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
\end_layout

\begin_layout Subsection
Publication Bandwidth Compression
\begin_inset CommandInset label
LatexCommand label
name "subsec:Publication-Bandwidth-Compression"

\end_inset


\end_layout

\begin_layout Standard
The number of Observers attempting to regularly download a new version of
 a Publication from a Publisher is likely to be extremely high: it is not
 implausible to assume 100
\begin_inset space ~
\end_inset

million Observers attempting a new download once per hour.
\end_layout

\begin_layout Standard
The design choices for the 
\series bold
Notification
\series default
 data object defined in section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Notification-fields"
plural "false"
caps "false"
noprefix "false"

\end_inset

 minimise the encoding overhead in each Publication.
\end_layout

\begin_layout Standard
The 
\series bold
nextUpdateNotBefore
\series default
 field defined in section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "par:TBSPublicationData-nextUpdateNotBefore"
plural "false"
caps "false"
noprefix "false"

\end_inset

 provides a cooperative mechanism for attempting to impose some level of
 adaptive rate control upon Observers, and standard HTTP mechanisms such
 as ETags can be used to eliminate wholly unnecessary downloads.
\end_layout

\begin_layout Standard
The 
\series bold
excludesPublishedBefore
\series default
 field defined in section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "par:TBSPublicationData-excludesPublishedBefore"
plural "false"
caps "false"
noprefix "false"

\end_inset

 can be used to create a partial Publication that elides Seed Values for
 which the Alert Level has not changed since a previous Publication.
\end_layout

\begin_layout Standard
The 
\series bold
updateURLs
\series default
 field defined in section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "par:TBSPublicationData-updateURLs"
plural "false"
caps "false"
noprefix "false"

\end_inset

 can be used to direct Observers to download a Publication that has been
 constructed with an appropriate 
\series bold
excludesPublishedBefore
\series default
 time, in a manner that is compatible with the use of any Content Distribution
 Network (CDN).
 The mechanism works with static Publication files that are generated by
 a Publisher according to a Publisher-specific schedule and then uploaded
 to predefined static URLs within the CDN.
 This eliminates any requirement to generate Publications on demand in response
 to a request from an Observer, and also eliminates any requirement to deploy
 application logic to interpret the URL requested by the Observer.
\end_layout

\begin_layout Standard
As a worked example, consider a Publisher that adopts a policy as follows:
\end_layout

\begin_layout Itemize
For each new version of a Publication published at time 
\begin_inset Formula $T$
\end_inset

, the Publisher chooses three cut-off times:
\end_layout

\begin_deeper
\begin_layout Itemize
\begin_inset Formula $T_{h1}$
\end_inset

 the start of the hour containing 
\begin_inset Formula $T$
\end_inset


\end_layout

\begin_layout Itemize
\begin_inset Formula $T_{h2}$
\end_inset

 the start of the hour before the hour containing 
\begin_inset Formula $T$
\end_inset


\end_layout

\begin_layout Itemize
\begin_inset Formula $T_{d1}$
\end_inset

 the start of the day containing 
\begin_inset Formula $T$
\end_inset


\end_layout

\end_deeper
\begin_layout Itemize
The Publisher constructs four static files:
\end_layout

\begin_deeper
\begin_layout Itemize
\begin_inset Formula $P_{\text{\ensuremath{\Omega}}}$
\end_inset

 with 
\series bold
publishedAt
\series default
 set to time 
\begin_inset Formula $T$
\end_inset

 and no 
\series bold
excludesPublishedBefore
\end_layout

\begin_layout Itemize
\begin_inset Formula $P_{h1}$
\end_inset

 with 
\series bold
publishedAt
\series default
 set to time 
\begin_inset Formula $T$
\end_inset

 and 
\series bold
excludesPublishedBefore
\series default
 set to time 
\begin_inset Formula $T_{h1}$
\end_inset


\end_layout

\begin_layout Itemize
\begin_inset Formula $P_{h2}$
\end_inset

 with 
\series bold
publishedAt
\series default
 set to time 
\begin_inset Formula $T$
\end_inset

 and 
\series bold
excludesPublishedBefore
\series default
 set to time 
\begin_inset Formula $T_{h2}$
\end_inset


\end_layout

\begin_layout Itemize
\begin_inset Formula $P_{d1}$
\end_inset

 with 
\series bold
publishedAt
\series default
 set to time 
\begin_inset Formula $T$
\end_inset

 and 
\series bold
excludesPublishedBefore
\series default
 set to time 
\begin_inset Formula $T_{d1}$
\end_inset


\end_layout

\end_deeper
\begin_layout Itemize
The Publisher publishes these static files to a CDN as follows:
\end_layout

\begin_deeper
\begin_layout Itemize
\begin_inset Formula $P_{\Omega}$
\end_inset

 is published to the URL 
\begin_inset Flex URL
status open

\begin_layout Plain Layout

https://publisher.dns.name/pub/full
\end_layout

\end_inset


\end_layout

\begin_layout Itemize
\begin_inset Formula $P_{h1}$
\end_inset

, 
\begin_inset Formula $P_{h2}$
\end_inset

, and 
\begin_inset Formula $P_{d1}$
\end_inset

 are published to URLs constructed as 
\begin_inset Flex URL
status open

\begin_layout Plain Layout

https://publisher.dns.name/pub/{yyyymmddhh}
\end_layout

\end_inset

 where 
\begin_inset Flex URL
status open

\begin_layout Plain Layout

{yyyymmddhh}
\end_layout

\end_inset

 are times 
\begin_inset Formula $T_{h1}$
\end_inset

, 
\begin_inset Formula $T_{h2}$
\end_inset

, and 
\begin_inset Formula $T_{d1}$
\end_inset

 respectively.
\end_layout

\end_deeper
\begin_layout Itemize
The Publisher ensures that all four files contain the same 
\series bold
updateURLs
\series default
 list, which contains, in order:
\end_layout

\begin_deeper
\begin_layout Itemize
\begin_inset Flex URL
status open

\begin_layout Plain Layout

https://publisher.dns.name/pub/{yyyymmddhh}
\end_layout

\end_inset

 where 
\begin_inset Flex URL
status open

\begin_layout Plain Layout

{yyyymmddhh}
\end_layout

\end_inset

 is time 
\begin_inset Formula $T_{h1}$
\end_inset


\end_layout

\begin_layout Itemize
\begin_inset Flex URL
status open

\begin_layout Plain Layout

https://publisher.dns.name/pub/{yyyymmddhh}
\end_layout

\end_inset

 where 
\begin_inset Flex URL
status open

\begin_layout Plain Layout

{yyyymmddhh}
\end_layout

\end_inset

 is time 
\begin_inset Formula $T_{d1}$
\end_inset


\end_layout

\begin_layout Itemize
\begin_inset Flex URL
status open

\begin_layout Plain Layout

https://publisher.dns.name/pub/full
\end_layout

\end_inset


\end_layout

\begin_layout Standard
Note that the URL for time 
\series bold

\begin_inset Formula $T_{h2}$
\end_inset


\series default
 does not appear within the 
\series bold
updateURLs
\series default
 list.
\end_layout

\end_deeper
\begin_layout Itemize
The Publisher ensures that 
\series bold
nextUpdateNotAfter
\series default
 is always set to one hour after time 
\begin_inset Formula $T$
\end_inset

.
\end_layout

\begin_layout Standard
In this scenario, consider a Publication that occurs at 2020-04-12
\begin_inset space ~
\end_inset

21:39.
 The four published file URLs are then:
\end_layout

\begin_layout Itemize
\begin_inset Flex URL
status open

\begin_layout Plain Layout

https://publisher.dns.name/pub/full
\end_layout

\end_inset

 with 
\series bold
publishedAt
\series default
 set to 2020-04-12
\begin_inset space ~
\end_inset

21:39 and no 
\series bold
excludesPublishedBefore
\end_layout

\begin_layout Itemize
\begin_inset Flex URL
status open

\begin_layout Plain Layout

https://publisher.dns.name/pub/2020041221
\end_layout

\end_inset

 with 
\series bold
publishedAt
\series default
 set to 2020-04-12
\begin_inset space ~
\end_inset

21:39 and 
\series bold
excludesPublishedBefore
\series default
 set to 2020-04-12
\begin_inset space ~
\end_inset

21:00.
\end_layout

\begin_layout Itemize
\begin_inset Flex URL
status open

\begin_layout Plain Layout

https://publisher.dns.name/pub/2020041220
\end_layout

\end_inset

 with 
\series bold
publishedAt
\series default
 set to 2020-04-12
\begin_inset space ~
\end_inset

21:39 and 
\series bold
excludesPublishedBefore
\series default
 set to 2020-04-12
\begin_inset space ~
\end_inset

20:00.
\end_layout

\begin_layout Itemize
\begin_inset Flex URL
status open

\begin_layout Plain Layout

https://publisher.dns.name/pub/2020041200
\end_layout

\end_inset

 with 
\series bold
publishedAt
\series default
 set to 2020-04-12
\begin_inset space ~
\end_inset

21:39 and 
\series bold
excludesPublishedBefore
\series default
 set to 2020-04-12
\begin_inset space ~
\end_inset

00:00.
\end_layout

\begin_layout Standard
All four of these files include the same 
\series bold
updateURLs
\series default
 list which contains, in order:
\end_layout

\begin_layout Itemize
\begin_inset Flex URL
status open

\begin_layout Plain Layout

https://publisher.dns.name/pub/2020041221
\end_layout

\end_inset


\end_layout

\begin_layout Itemize
\begin_inset Flex URL
status open

\begin_layout Plain Layout

https://publisher.dns.name/pub/2020041200
\end_layout

\end_inset


\end_layout

\begin_layout Itemize
\begin_inset Flex URL
status open

\begin_layout Plain Layout

https://publisher.dns.name/pub/full
\end_layout

\end_inset


\end_layout

\begin_layout Standard
Once an Observer has retrieved any of the published files, the above policy
 ensures that:
\end_layout

\begin_layout Itemize
An Observer that attempts to retrieve the next update within one hour will
 always retrieve the smallest available partial Publication 
\begin_inset Formula $P_{h1}$
\end_inset

.
\end_layout

\begin_layout Itemize
An Observer that delays for more than one hour but attempts to retrieve
 the next update within two hours will always retrieve the next smallest
 available partial Publication 
\begin_inset Formula $P_{h2}$
\end_inset

.
\end_layout

\begin_layout Itemize
An Observer that delays more than two hours but attempts to retrieve the
 next update within the same day will find an invalid Publication (or a
 deleted Publication) on its first retrieval attempt, and will then retrieve
 the next smallest available partial Publication 
\begin_inset Formula $P_{d1}$
\end_inset

.
\end_layout

\begin_layout Itemize
An Observer that delays until the next day will find an invalid Publication
 (or a deleted Publication) on its first and second retrieval attempts,
 and will then retrieve the full Publication 
\begin_inset Formula $P_{\Omega}$
\end_inset

.
\end_layout

\begin_layout Standard
The behaviour mandated for 
\series bold
publishedAt
\series default
 (section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "par:TBSPublicationData-publishedAt"
plural "false"
caps "false"
noprefix "false"

\end_inset

), 
\series bold
nextUpdateNotAfter
\series default
 (section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "par:TBSPublicationData-nextUpdateNotAfter"
plural "false"
caps "false"
noprefix "false"

\end_inset

), 
\series bold
excludesPublishedBefore
\series default
 (section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "par:TBSPublicationData-excludesPublishedBefore"
plural "false"
caps "false"
noprefix "false"

\end_inset

) and 
\series bold
updateURLs
\series default
 (section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "par:TBSPublicationData-updateURLs"
plural "false"
caps "false"
noprefix "false"

\end_inset

) ensures that the Observer will recover from failure scenarios arising
 from likely implementation errors (such as the failure to delete stale
 content from a CDN).
\end_layout

\begin_layout Section
Publisher Endpoints
\begin_inset CommandInset label
LatexCommand label
name "sec:Publisher-Endpoints"

\end_inset


\end_layout

\begin_layout Standard
A Publisher Endpoint is a URL used to interact with a Publisher by Advertisers,
 Observers, and other Publishers.
\end_layout

\begin_layout Standard
All Publisher Endpoints defined by this document are open access (with no
 authentication required), since there is by design no concept of user identity.
 Authorization is handled where needed through in-band cryptographic operations,
 such as the use of a Seed Report Challenge (see section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Seed-Report-Challenges"
plural "false"
caps "false"
noprefix "false"

\end_inset

).
\end_layout

\begin_layout Standard
All Publisher Endpoint URLs are discovered via a Publisher Descriptor as
 defined in section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Publisher-Descriptors"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
\end_layout

\begin_layout Subsection
Publisher Descriptor Endpoint
\begin_inset CommandInset label
LatexCommand label
name "subsec:Publisher-Descriptor-Endpoint"

\end_inset


\end_layout

\begin_layout Standard
A Publisher Descriptor Endpoint is a URL that provides the Publisher Descriptor
 for the Publisher as defined in section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Publisher-Descriptors"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
 It is discovered via the 
\series bold
url
\series default
 property of the Publisher Descriptor as defined in section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Publisher-url"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
\end_layout

\begin_layout Description
Transport HTTPS only
\end_layout

\begin_layout Description
Method GET
\end_layout

\begin_layout Description
Parameters None
\end_layout

\begin_layout Description
Response
\begin_inset space ~
\end_inset

Content-Type application/json
\end_layout

\begin_layout Description
Response
\begin_inset space ~
\end_inset

Content The Publisher Descriptor as defined in section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Publisher-Descriptors"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
\end_layout

\begin_layout Standard
A Publisher SHALL fail requests to this endpoint if made through any transport
 other than HTTPS.
\end_layout

\begin_layout Standard
An Advertiser, Observer, or Publisher SHALL refuse to attempt to retrieve
 content from this endpoint through any transport other than HTTPS.
\end_layout

\begin_layout Subsection
Seed Report Endpoint
\begin_inset CommandInset label
LatexCommand label
name "subsec:Seed-Report-Endpoint"

\end_inset


\end_layout

\begin_layout Standard
A Seed Report Endpoint is a URL through which a Seed Report (see section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Seed-Reports"
plural "false"
caps "false"
noprefix "false"

\end_inset

) can be submitted to the Publisher.
 It is discovered via the 
\series bold
report
\series default
 property of the Publisher Descriptor as defined in section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Publisher-report"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
\end_layout

\begin_layout Description
Transport HTTPS only
\end_layout

\begin_layout Description
Method POST
\end_layout

\begin_layout Description
Parameters None
\end_layout

\begin_layout Description
Request
\begin_inset space ~
\end_inset

Content-Type: application/octet-stream
\end_layout

\begin_layout Description
Request
\begin_inset space ~
\end_inset

Content: An ASN.1
\begin_inset space ~
\end_inset

DER
\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand cite
key "X.690"
literal "false"

\end_inset

 encoded Seed Report as defined in section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Seed-Report-Layout"
plural "false"
caps "false"
noprefix "false"

\end_inset


\end_layout

\begin_layout Description
Response
\begin_inset space ~
\end_inset

Content-Type: text/html (in the case of an error status code)
\end_layout

\begin_layout Description
Response Status code only, with a human-readable HTML error description
 in the case of an error status code.
\end_layout

\begin_layout Standard
A Publisher SHALL fail requests to this endpoint if made through any transport
 other than HTTPS.
\end_layout

\begin_layout Standard
A Pubisher SHALL report a success status code if and only if the Seed Report
 is successfully validated as described in section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Seed-Reports"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
\end_layout

\begin_layout Standard
An Advertiser SHALL refuse to attempt to retrieve content from this endpoint
 through any transport other than HTTPS.
\end_layout

\begin_layout Standard
An Advertiser SHALL provide an indication to the user as to whether or not
 the reponse was successful, and SHOULD provide an opportunity for the user
 to view the HTML error description if the response was not successful.
\end_layout

\begin_layout Subsection
Publication Endpoint
\begin_inset CommandInset label
LatexCommand label
name "subsec:Publication-Endpoint"

\end_inset


\end_layout

\begin_layout Standard
A Publication Endpoint is a URL that provides the current version of a Publicati
on (see section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Publications"
plural "false"
caps "false"
noprefix "false"

\end_inset

).
 It is discovered via the 
\series bold
pub
\series default
 or 
\series bold
pubs
\series default
 properties of the Publisher Descriptor as defined in sections
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Publisher-pub"
plural "false"
caps "false"
noprefix "false"

\end_inset

 and
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Publisher-pubs"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
\end_layout

\begin_layout Description
Transport HTTP or HTTPS
\end_layout

\begin_layout Description
Method GET
\end_layout

\begin_layout Description
Parameters None
\end_layout

\begin_layout Description
Response
\begin_inset space ~
\end_inset

Content-Type application/octet-stream
\end_layout

\begin_layout Description
Response
\begin_inset space ~
\end_inset

Content An ASN.1 DER
\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand cite
key "X.690"
literal "false"

\end_inset

 encoded Publication as defined in section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Publication-Layout"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
\end_layout

\begin_layout Standard
The Publication MAY be retrieved via HTTP since the content itself includes
 an embedded digital signature and so does not rely on transport level security.
 This design choice also allows for future extensions to support distribution
 through alternative mechanisms such as peer-to-peer file sharing.
\end_layout

\begin_layout Standard
A Publisher SHALL provide at least one Publication Endpoint for use by Observers
, and MAY provide additional Publication Endpoints for use by other Publishers.
\end_layout

\begin_layout Standard
Note that the Publication Endpoint URL provides only the uncompressed Publicatio
n (see section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Publication-Bandwidth-Compression"
plural "false"
caps "false"
noprefix "false"

\end_inset

).
 The URLs for any bandwidth-compressed Publications are obtained from the
 
\series bold
updateURLs
\series default
 field of the Publication itself as defined in section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "par:TBSPublicationData-updateURLs"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
\end_layout

\begin_layout Section
Publisher Descriptors
\begin_inset CommandInset label
LatexCommand label
name "sec:Publisher-Descriptors"

\end_inset


\end_layout

\begin_layout Standard
A Publisher Descriptor is a JSON
\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand cite
key "RFC8259"
literal "false"

\end_inset

 document created by a Publisher and made available for download by Advertisers,
 Observers, and other Publishers.
 It is used to describe all relevant attributes of a Publisher, such as
 the Publisher Name, the Publisher Certificate, the URL used for submitting
 Seed Reports, the URL used for retrieving the default Publication, and
 so on.
\end_layout

\begin_layout Standard
It is expected that Advertisers and Observers are likely to include a preset
 list of well-known Publisher Descriptors, so that users are able to simply
 choose from a list, or to have a suitable default choice made automatically
 based on available information such as a Mobile Country Code obtained from
 a local mobile phone network.
 A Publisher that is not included in a preset list may still be used by
 any Advertiser or Observer by simply entering the URL for the Publisher
 Descriptor: this ensures that all Advertisers and Observers are able to
 use any Publisher.
\end_layout

\begin_layout Standard
The Publisher Descriptor itself is not signed, since it functions as the
 root of trust for a Publisher.
\end_layout

\begin_layout Subsection
Publisher Descriptor Layout
\begin_inset CommandInset label
LatexCommand label
name "subsec:Publisher-Descriptor-Layout"

\end_inset


\end_layout

\begin_layout Standard
A Publisher Descriptor is a JSON
\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand cite
key "RFC8259"
literal "false"

\end_inset

 serialisation of an 
\begin_inset Flex URL
status open

\begin_layout Plain Layout

http://cx.ipxe.org/json/publisher
\end_layout

\end_inset

 object, which has the properties defined in this section.
 A full JSON schema
\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand cite
key "JSONSchema"
literal "false"

\end_inset

 is provided in Appendix
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "sec:JSON-Schema"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
\end_layout

\begin_layout Subsubsection
url
\begin_inset CommandInset label
LatexCommand label
name "subsec:Publisher-url"

\end_inset


\end_layout

\begin_layout Standard
The 
\series bold
url
\series default
 property contains the authoritative absoute URL of the Publsiher Descriptor
 Endpoint as defined in section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Publisher-Descriptor-Endpoint"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
 It is used to retrieve updated versions of the Publisher Descriptor.
\end_layout

\begin_layout Standard
A Publisher SHALL set this property to the absolute URL of the Publisher
 Descriptor Endpoint as defined in section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Publisher-Descriptor-Endpoint"
plural "false"
caps "false"
noprefix "false"

\end_inset

, and SHALL use the 
\family typewriter
https
\family default
 URL scheme.
\end_layout

\begin_layout Standard
An Advertiser, Observer, or consuming Publisher SHALL retrieve an updated
 Publisher Descriptor from this URL as defined in section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Publisher-Descriptor-Endpoint"
plural "false"
caps "false"
noprefix "false"

\end_inset

 (as needed or in response to an explicit user request), and SHALL replace
 any stored Publisher Descriptor for the same Publisher if and only if:
\end_layout

\begin_layout Itemize
the retrieved Publisher Descriptor is successfully validated, and
\end_layout

\begin_layout Itemize
the updated Publisher Descriptor contains a 
\series bold
url
\series default
 property from which an identical copy of the updated Publisher Descriptor
 can be successfully retrieved.
\end_layout

\begin_layout Standard
An Advertiser, Observer, or consuming Publisher SHALL treat the Publisher
 Descriptor as invalid if the 
\series bold
url
\series default
 property is not present, is empty, contains a value that is not an absolute
 URL, or contains a value that uses a URL scheme other than 
\family typewriter
https
\family default
.
\end_layout

\begin_layout Subsubsection
cert
\begin_inset CommandInset label
LatexCommand label
name "subsec:Publisher-cert"

\end_inset


\end_layout

\begin_layout Standard
The 
\series bold
cert
\series default
 property contains the Publisher Certificate in PEM
\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand cite
key "RFC7468"
literal "false"

\end_inset

 format.
 It is used to verify Publications as described in section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:PublicationContentInfo-fields"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
\end_layout

\begin_layout Standard
Experience suggests that some Publishers are likely to struggle to comply
 with any cryptographic requirements over and above the use of a basic self-sign
ed certificate.
 This document therefore does not impose a requirement that the Publisher
 Certificate be signed by a trusted CA, or that the certificate include
 any particular X.509
\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand cite
key "RFC5280"
literal "false"

\end_inset

 extensions or key usages.
\end_layout

\begin_layout Standard
A Publisher SHALL set this property to the PEM encoding of the Publisher
 Certificate that it intends to use to sign Publications as described in
 section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:PublicationContentInfo-fields"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
\end_layout

\begin_layout Standard
An Advertiser, Observer, or consuming Publisher SHALL treat the Publisher
 Descriptor as invalid if the 
\series bold
cert
\series default
 property is not present, is empty, or contains a value that cannot be parsed
 as an X.509
\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand cite
key "RFC5280"
literal "false"

\end_inset

 certificate in PEM
\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand cite
key "RFC7468"
literal "false"

\end_inset

 format.
\end_layout

\begin_layout Subsubsection
name
\begin_inset CommandInset label
LatexCommand label
name "subsec:Publisher-name"

\end_inset


\end_layout

\begin_layout Standard
The 
\series bold
name
\series default
 property contains a human-readable name for the Publisher.
 It is used as part of the Seed Report Challenge as defined in section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "par:TBSSeedReport-publisherName"
plural "false"
caps "false"
noprefix "false"

\end_inset

 and MAY be displayed to users as part of a user interface.
\end_layout

\begin_layout Standard
A Publisher SHALL set this property to a human-readable name for the Publisher
 that is sufficiently detailed to allow the Publisher to be unambiguously
 identified by any user worldwide, including users outside of the Publisher's
 domain.
 For example: a name such as 
\begin_inset Quotes eld
\end_inset

Government Health Agency
\begin_inset Quotes erd
\end_inset

 is too ambiguous since the governmental country is not specified.
\end_layout

\begin_layout Standard
An Advertiser SHALL use the value of this property when constructing a Seed
 Report Challenge for this Publisher as defined in section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "par:TBSSeedReport-seedReportChallenge"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
\end_layout

\begin_layout Standard
An Advertiser, Observer, or consuming Publisher SHALL treat the Publisher
 Descriptor as invalid if the 
\series bold
name
\series default
 property is not present, is empty, or contains a value that is not a UTF-8
 string.
\end_layout

\begin_layout Subsubsection
logo
\begin_inset CommandInset label
LatexCommand label
name "subsec:Publisher-logo"

\end_inset


\end_layout

\begin_layout Standard
The OPTIONAL 
\series bold
logo
\series default
 property contains an absolute URL for a graphical logo for the Publisher.
 The graphical logo MAY be displayed to the user as part of a user interface.
\end_layout

\begin_layout Standard
A Publisher MAY set this property to an absolute URL for a graphical logo
 that the Publisher believes will help users recognise the Publisher.
 The content type of the logo MAY be any graphical format that is commonly
 supported by typical web browsers.
\end_layout

\begin_layout Standard
An Advertiser or Observer MAY retrieve this URL and display the graphical
 logo as part of a user interface.
\end_layout

\begin_layout Standard
An Advertiser, Observer, or consuming Publisher SHALL treat the Publisher
 Descriptor as invalid if the 
\series bold
logo
\series default
 property is present and contains a value that is not an absolute URL.
\end_layout

\begin_layout Subsubsection
report
\begin_inset CommandInset label
LatexCommand label
name "subsec:Publisher-report"

\end_inset


\end_layout

\begin_layout Standard
The 
\series bold
report
\series default
 property contains the absolute URL of the Seed Report Endpoint as defined
 in section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Seed-Report-Endpoint"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
 It is used by Advertisers to submit the constructed Seed Report as defined
 in section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Seed-Reports"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
\end_layout

\begin_layout Standard
A Publisher SHALL set this property to the absolute URL of the Seed Report
 Endpoint as defined in section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Seed-Report-Endpoint"
plural "false"
caps "false"
noprefix "false"

\end_inset

, and SHALL use the 
\family typewriter
https
\family default
 URL scheme.
\end_layout

\begin_layout Standard
An Advertiser SHALL submit Seed Reports for this Publisher to this URL as
 defined in section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Seed-Report-Endpoint"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
\end_layout

\begin_layout Standard
An Advertiser, Observer, or consuming Publisher SHALL treat the Publisher
 Descriptor as invalid if the 
\series bold
report
\series default
 property is not present, is empty, contains a value that is not an absolute
 URL, or contains a value that uses a URL scheme other than 
\family typewriter
https
\family default
.
\end_layout

\begin_layout Subsubsection
pub
\begin_inset CommandInset label
LatexCommand label
name "subsec:Publisher-pub"

\end_inset


\end_layout

\begin_layout Standard
The 
\series bold
pub
\series default
 property contains the absolute URL of the default Publication Endpoint
 as defined in section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Publication-Endpoint"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
 It is used by Observers to retrieve Publications as defined in section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Publications"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
\end_layout

\begin_layout Standard
A Publisher SHALL set this property to the absolute URL of the Publication
 Endpoint as defined in section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Publication-Endpoint"
plural "false"
caps "false"
noprefix "false"

\end_inset

 for the Publication that is intended to be consumed by Observers, and SHALL
 use the 
\family typewriter
https
\family default
 URL scheme.
\end_layout

\begin_layout Standard
An Observer SHALL retrieve Publications from this URL as defined in section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Publication-Endpoint"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
\end_layout

\begin_layout Standard
An Advertiser, Observer, or consuming Publisher SHALL treat the Publisher
 Descriptor as invalid if the 
\series bold
pub
\series default
 property is not present, is empty, contains a value that is not an absolute
 URL, or contains a value that uses a URL scheme other than 
\family typewriter
https
\family default
.
\end_layout

\begin_layout Subsubsection
pubs
\begin_inset CommandInset label
LatexCommand label
name "subsec:Publisher-pubs"

\end_inset


\end_layout

\begin_layout Standard
TODO
\end_layout

\begin_layout Standard
\start_of_appendix
\begin_inset CommandInset bibtex
LatexCommand bibtex
btprint "btPrintCited"
bibfiles "cx"
options "plain"

\end_inset


\end_layout

\begin_layout Part*
Appendix
\end_layout

\begin_layout Section
Generator Sample Code
\begin_inset CommandInset label
LatexCommand label
name "sec:Generator-Sample-Code"

\end_inset


\end_layout

\begin_layout Standard
This sample code is provided as a reference implementation showing the correct
 sequence of calls to standard OpenSSL
\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand cite
key "OpenSSL"
literal "false"

\end_inset

 library functions in order to produce the REQUIRED sequence of Contact
 Identifiers for a given Generator Type and Seed Value.
\end_layout

\begin_layout Standard
All input validity checks and error handling are omitted from this sample
 code in the interests of brevity.
 This sample code MUST NOT be used verbatim.
 A more complete reference implementation is available from 
\begin_inset Flex URL
status open

\begin_layout Plain Layout

https://github.com/ipxe/cx
\end_layout

\end_inset

.
\end_layout

\begin_layout Standard
\begin_inset CommandInset include
LatexCommand inputminted
filename "gen_sample.c"
lstparams "language=C"

\end_inset


\end_layout

\begin_layout Section
Generator Test Vectors
\begin_inset CommandInset label
LatexCommand label
name "sec:Generator-Test-Vectors"

\end_inset


\end_layout

\begin_layout Standard
Each test vector input comprises a Generator Type and a Seed Value.
\end_layout

\begin_layout Standard
Each test vector output comprises a pair of Contact Identifiers: the first
 and last Contact Identifiers that MUST be generated by iterating over the
 Generator.
\end_layout

\begin_layout Subsection
Generator Type 1, natural number seed
\end_layout

\begin_layout Standard
This test vector uses Generator Type 1 (as defined in section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Generator-Types"
plural "false"
caps "false"
noprefix "false"

\end_inset

) with a seed constructed from the first 24 natural numbers.
\end_layout

\begin_layout Standard
\begin_inset CommandInset include
LatexCommand inputminted
filename "gen_type1_test1.c"
lstparams "language=C"

\end_inset


\end_layout

\begin_layout Subsection
Generator Type 1, random seed
\end_layout

\begin_layout Standard
This test vector uses Generator Type 1 (as defined in section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Generator-Types"
plural "false"
caps "false"
noprefix "false"

\end_inset

) with a seed constructed from 24 randomly chosen bytes.
\end_layout

\begin_layout Standard
\begin_inset CommandInset include
LatexCommand inputminted
filename "gen_type1_test2.c"
lstparams "language=C"

\end_inset


\end_layout

\begin_layout Subsection
Generator Type 2, natural number seed
\end_layout

\begin_layout Standard
This test vector uses Generator Type 2 (as defined in section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Generator-Types"
plural "false"
caps "false"
noprefix "false"

\end_inset

) with a seed constructed from the first 48 natural numbers.
\end_layout

\begin_layout Standard
\begin_inset CommandInset include
LatexCommand inputminted
filename "gen_type2_test1.c"
lstparams "language=C"

\end_inset


\end_layout

\begin_layout Subsection
Generator Type 2, random seed
\end_layout

\begin_layout Standard
This test vector uses Generator Type 2 (as defined in section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Generator-Types"
plural "false"
caps "false"
noprefix "false"

\end_inset

) with a seed constructed from 48 randomly chosen bytes.
\end_layout

\begin_layout Standard
\begin_inset CommandInset include
LatexCommand inputminted
filename "gen_type2_test2.c"
lstparams "language=C"

\end_inset


\end_layout

\begin_layout Section
Seed Calculator Sample Code
\begin_inset CommandInset label
LatexCommand label
name "sec:Seed-Calculator-Sample"

\end_inset


\end_layout

\begin_layout Standard
This sample code is provided as a reference implementation showing the correct
 sequence of calls to standard OpenSSL
\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand cite
key "OpenSSL"
literal "false"

\end_inset

 library functions in order to produce the REQUIRED Seed Value for a given
 Generator Type, Preseed Value, and Preseed Verification Key.
\end_layout

\begin_layout Standard
All input validity checks and error handling are omitted from this sample
 code in the interests of brevity.
 This sample code MUST NOT be used verbatim.
 A more complete reference implementation is available from 
\begin_inset Flex URL
status open

\begin_layout Plain Layout

https://github.com/ipxe/cx
\end_layout

\end_inset

.
\end_layout

\begin_layout Standard
\begin_inset CommandInset include
LatexCommand inputminted
filename "seedcalc_sample.c"
lstparams "language=C"

\end_inset


\end_layout

\begin_layout Section
Seed Calculator Test Vectors
\begin_inset CommandInset label
LatexCommand label
name "sec:Seed-Calculator-Test"

\end_inset


\end_layout

\begin_layout Standard
Each test vector input comprises a Preseed Value and a Preseed Verification
 Key (shown in PEM form).
\end_layout

\begin_layout Standard
Each test vector output comprises a Seed Value that MUST be constructed
 by using the Seed Calculator.
\end_layout

\begin_layout Subsection
Generator Type 1, natural number preseed, public key 
\begin_inset Quotes eld
\end_inset

A
\begin_inset Quotes erd
\end_inset


\end_layout

\begin_layout Standard
This test vector uses Generator Type 1 (as defined in section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Generator-Types"
plural "false"
caps "false"
noprefix "false"

\end_inset

) with a preseed constructed from the first 24 natural numbers and public
 key 
\begin_inset Quotes eld
\end_inset

A
\begin_inset Quotes erd
\end_inset

.
\end_layout

\begin_layout Standard
\begin_inset CommandInset include
LatexCommand inputminted
filename "fensystems.pubkey.pem"

\end_inset


\end_layout

\begin_layout Standard
\begin_inset CommandInset include
LatexCommand inputminted
filename "seedcalc_type1_test1.c"
lstparams "language=C"

\end_inset


\end_layout

\begin_layout Subsection
Generator Type 1, natural number preseed, public key 
\begin_inset Quotes eld
\end_inset

B
\begin_inset Quotes erd
\end_inset


\end_layout

\begin_layout Standard
This test vector uses Generator Type 1 (as defined in section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Generator-Types"
plural "false"
caps "false"
noprefix "false"

\end_inset

) with a preseed constructed from the first 24 natural numbers and public
 key 
\begin_inset Quotes eld
\end_inset

B
\begin_inset Quotes erd
\end_inset

.
\end_layout

\begin_layout Standard
\begin_inset CommandInset include
LatexCommand inputminted
filename "ipxe.pubkey.pem"

\end_inset


\end_layout

\begin_layout Standard
\begin_inset CommandInset include
LatexCommand inputminted
filename "seedcalc_type1_test2.c"
lstparams "language=C"

\end_inset


\end_layout

\begin_layout Subsection
Generator Type 1, random preseed, public key 
\begin_inset Quotes eld
\end_inset

B
\begin_inset Quotes erd
\end_inset


\end_layout

\begin_layout Standard
This test vector uses Generator Type 1 (as defined in section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Generator-Types"
plural "false"
caps "false"
noprefix "false"

\end_inset

) with a preseed constructed from 24 randomly chosen bytes and public key
 
\begin_inset Quotes eld
\end_inset

B
\begin_inset Quotes erd
\end_inset

.
\end_layout

\begin_layout Standard
\begin_inset CommandInset include
LatexCommand inputminted
filename "ipxe.pubkey.pem"

\end_inset


\end_layout

\begin_layout Standard
\begin_inset CommandInset include
LatexCommand inputminted
filename "seedcalc_type1_test3.c"
lstparams "language=C"

\end_inset


\end_layout

\begin_layout Subsection
Generator Type 2, natural number preseed, public key 
\begin_inset Quotes eld
\end_inset

A
\begin_inset Quotes erd
\end_inset


\end_layout

\begin_layout Standard
This test vector uses Generator Type 2 (as defined in section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Generator-Types"
plural "false"
caps "false"
noprefix "false"

\end_inset

) with a preseed constructed from the first 48 natural numbers and public
 key 
\begin_inset Quotes eld
\end_inset

A
\begin_inset Quotes erd
\end_inset

.
\end_layout

\begin_layout Standard
\begin_inset CommandInset include
LatexCommand inputminted
filename "fensystems.pubkey.pem"

\end_inset


\end_layout

\begin_layout Standard
\begin_inset CommandInset include
LatexCommand inputminted
filename "seedcalc_type2_test1.c"
lstparams "language=C"

\end_inset


\end_layout

\begin_layout Subsection
Generator Type 2, natural number preseed, public key 
\begin_inset Quotes eld
\end_inset

B
\begin_inset Quotes erd
\end_inset


\end_layout

\begin_layout Standard
This test vector uses Generator Type 2 (as defined in section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Generator-Types"
plural "false"
caps "false"
noprefix "false"

\end_inset

) with a preseed constructed from the first 48 natural numbers and public
 key 
\begin_inset Quotes eld
\end_inset

B
\begin_inset Quotes erd
\end_inset

.
\end_layout

\begin_layout Standard
\begin_inset CommandInset include
LatexCommand inputminted
filename "ipxe.pubkey.pem"

\end_inset


\end_layout

\begin_layout Standard
\begin_inset CommandInset include
LatexCommand inputminted
filename "seedcalc_type2_test2.c"
lstparams "language=C"

\end_inset


\end_layout

\begin_layout Subsection
Generator Type 2, random preseed, public key 
\begin_inset Quotes eld
\end_inset

B
\begin_inset Quotes erd
\end_inset


\end_layout

\begin_layout Standard
This test vector uses Generator Type 2 (as defined in section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Generator-Types"
plural "false"
caps "false"
noprefix "false"

\end_inset

) with a preseed constructed from 48 randomly chosen bytes and public key
 
\begin_inset Quotes eld
\end_inset

B
\begin_inset Quotes erd
\end_inset

.
\end_layout

\begin_layout Standard
\begin_inset CommandInset include
LatexCommand inputminted
filename "ipxe.pubkey.pem"

\end_inset


\end_layout

\begin_layout Standard
\begin_inset CommandInset include
LatexCommand inputminted
filename "seedcalc_type2_test3.c"
lstparams "language=C"

\end_inset


\end_layout

\begin_layout Section
ASN.1 Schema
\begin_inset CommandInset label
LatexCommand label
name "sec:ASN.1-Schema"

\end_inset


\end_layout

\begin_layout Standard
This schema includes all ASN.1
\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand cite
key "X.680"
literal "false"

\end_inset

 data objects defined by this specification.
 The imported definitions for AlgorithmIdentifier and SubjectPublicKeyInfo
 may be found in RFC
\begin_inset space ~
\end_inset

5280
\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand cite
key "RFC5280"
literal "false"

\end_inset

, and for ContentInfo in RFC
\begin_inset space ~
\end_inset

5652
\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand cite
key "RFC5652"
literal "false"

\end_inset

.
\end_layout

\begin_layout Standard
\begin_inset CommandInset include
LatexCommand inputminted
filename "cx.asn1"
lstparams "language=Clean,samepage=false"

\end_inset


\end_layout

\begin_layout Section
JSON Schema
\begin_inset CommandInset label
LatexCommand label
name "sec:JSON-Schema"

\end_inset


\end_layout

\begin_layout Subsection
Publisher Descriptor
\end_layout

\begin_layout Standard
This JSON schema
\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand cite
key "JSONSchema"
literal "false"

\end_inset

 covers the Publisher Descriptor object defined in section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Publisher-Descriptors"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
\end_layout

\begin_layout Standard
\begin_inset CommandInset include
LatexCommand inputminted
filename "publisher.json"
lstparams "language=JSON,samepage=false"

\end_inset


\end_layout

\end_body
\end_document
